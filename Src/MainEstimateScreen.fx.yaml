"MainEstimateScreen As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    Height: =Max(App.Height, App.DesignHeight)
    OnVisible: |
        =UpdateContext({ShowMainSpinner:true, NewEstPopUp:false, NewEstPopMsgText:"", NewEstOkButton:false, EPCEditable:false, NewEst_AllPurposeOkButton:false,
              PatchEstBasicRes:Blank()
        });
        Refresh(Vendors);
        ClearCollect(VendorList, Vendors);
        Refresh(Contractors);
        ClearCollect(ContractorList, Contractors);
        Refresh(MarkUp_ContingencyTable);
        ClearCollect(MarkupList, MarkUp_ContingencyTable);
        Refresh(Estimates);
        UpdateContext({ShowMainSpinner: false});
        Set(m_Markup, 0.15); Set(m_contingency, 0.05);
        Set(e_Markup, 0.15); Set(e_contingency, 0.05);
        Set(x_Markup, 0.15); Set(x_contingency, 0.05);
        Set(c_Markup, 0.15); Set(c_contingency, 0.05);
    Orientation: =If(MainEstimateScreen.Width < MainEstimateScreen.Height, Layout.Vertical, Layout.Horizontal)
    Size: =1 + CountRows(App.SizeBreakpoints) - CountIf(App.SizeBreakpoints, Value >= MainEstimateScreen.Width)
    Width: =Max(App.Width, App.DesignWidth)

    NewEstimateScrnTitleBar As rectangle:
        BorderColor: =RGBA(36, 76, 90, 1)
        DisabledFill: =NewEstimateScrnTitleBar.Fill
        Fill: =RGBA(36, 76, 90, 1)
        FocusedBorderColor: =NewEstimateScrnTitleBar.BorderColor
        Height: =88
        HoverFill: =NewEstimateScrnTitleBar.Fill
        PressedFill: =NewEstimateScrnTitleBar.Fill
        Width: =1366
        ZIndex: =1

    EstimateScrnTitle As label:
        Align: =Align.Center
        BorderStyle: =BorderStyle.None
        Fill: =RGBA(36, 76, 90, 1)
        FocusedBorderColor: =EstimateScrnTitle.BorderColor
        Font: =Font.'Lato Light'
        Height: =88
        HoverBorderColor: =EstimateScrnTitle.BorderColor
        HoverColor: =EstimateScrnTitle.Color
        HoverFill: =EstimateScrnTitle.Fill
        PressedBorderColor: =EstimateScrnTitle.BorderColor
        PressedColor: =EstimateScrnTitle.Color
        PressedFill: =EstimateScrnTitle.Fill
        Size: =24
        Text: =If(NewEstimate, "New Estimate", "View Or Update Estimate")
        Width: =Parent.Width
        ZIndex: =2

    Canvas2_2 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =Parent.Height - Canvas2_2.Y
        Width: =Parent.Width
        Y: =NewEstimateScrnTitleBar.Y + NewEstimateScrnTitleBar.Height
        ZIndex: =3

        BasicInfo As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =480
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

            BasicInfo_Form As form:
                AcceptsFocus: =false
                DataSource: =Estimates
                Height: =474
                Item: |-
                    =If(Not(NewEstimate), 
                      LookUp(Estimates, ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                                  And Version = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type))
                Width: =1363
                ZIndex: =1

                ProjectID_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="ProjectID"
                    Default: =ThisItem.ProjectID
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Project ID"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =51
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "ProjectID")
                    Required: =true
                    Update: =DataCardValue1_2.Text
                    Width: =454
                    X: =0
                    Y: =0
                    ZIndex: =1

                    DataCardKey1_2 As label:
                        FocusedBorderColor: =DataCardKey1_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =36
                        HoverBorderColor: =DataCardKey1_2.BorderColor
                        HoverColor: =DataCardKey1_2.Color
                        HoverFill: =DataCardKey1_2.Fill
                        PressedBorderColor: =DataCardKey1_2.BorderColor
                        PressedColor: =DataCardKey1_2.Color
                        PressedFill: =DataCardKey1_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =125
                        Wrap: =false
                        X: =10
                        Y: =6
                        ZIndex: =1

                    DataCardValue1_2 As text:
                        Align: =Align.Center
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =If(NewEstimate, Parent.Default, ThisItem.ProjectID)
                        DelayOutput: =true
                        DisplayMode: =If(FirstSaveOnNewEstimate, DisplayMode.View,Parent.DisplayMode)
                        FocusedBorderColor: =DataCardValue1_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        OnChange: |-
                            =If(Trim(DataCardValue1_2.Text) = "",
                             UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                             If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  
                                                    Type = DataCardValue2_2.Text),
                            	UpdateContext({NewEstPopUp:true, 
                                                NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                            					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                                 Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true}),
                            					 false)
                            )
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =DataCardValue1_2.HoverBorderColor
                        PressedColor: =DataCardValue1_2.Color
                        PressedFill: =RGBA(255, 255, 255, 1)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =262
                        X: =162
                        Y: =10
                        ZIndex: =2

                    ErrorMessage1_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage1_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage1_2.BorderColor
                        HoverColor: =ErrorMessage1_2.Color
                        HoverFill: =ErrorMessage1_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage1_2.BorderColor
                        PressedColor: =ErrorMessage1_2.Color
                        PressedFill: =ErrorMessage1_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue1_2.Y + DataCardValue1_2.Height
                        ZIndex: =3

                EstimatedBy_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="EstimatedBy"
                    Default: =ThisItem.EstimatedBy
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Estimated By"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =51
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "EstimatedBy")
                    Required: =true
                    Update: =
                    Width: =454
                    X: =1
                    Y: =0
                    ZIndex: =1

                    DataCardKey9_2 As label:
                        FocusedBorderColor: =DataCardKey9_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =29
                        HoverBorderColor: =DataCardKey9_2.BorderColor
                        HoverColor: =DataCardKey9_2.Color
                        HoverFill: =DataCardKey9_2.Fill
                        PressedBorderColor: =DataCardKey9_2.BorderColor
                        PressedColor: =DataCardKey9_2.Color
                        PressedFill: =DataCardKey9_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =148
                        Wrap: =false
                        X: =10
                        Y: =9
                        ZIndex: =1

                    ErrorMessage9_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage9_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage9_2.BorderColor
                        HoverColor: =ErrorMessage9_2.Color
                        HoverFill: =ErrorMessage9_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage9_2.BorderColor
                        PressedColor: =ErrorMessage9_2.Color
                        PressedFill: =ErrorMessage9_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =60
                        Y: =
                        ZIndex: =3

                    Label41_2 As label:
                        Align: =Align.Center
                        BorderColor: =RGBA(36, 76, 90, 1)
                        BorderThickness: =2
                        FocusedBorderColor: =Label41_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =Label41_2.BorderColor
                        HoverColor: =Label41_2.Color
                        HoverFill: =Label41_2.Fill
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =Label41_2.BorderColor
                        PressedColor: =Label41_2.Color
                        PressedFill: =Label41_2.Fill
                        Size: =12
                        Text: =User().FullName
                        Width: =280
                        X: =170
                        Y: =9
                        ZIndex: =5

                DateCreated_DataCard1_2 As typedDataCard.dateEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="DateCreated"
                    Default: =ThisItem.DateCreated
                    DisplayMode: =DisplayMode.Edit
                    DisplayName: ="Date Created"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =47
                    Required: =true
                    Update: =
                    Width: =454
                    X: =2
                    Y: =0
                    ZIndex: =1

                    DataCardKey6_2 As label:
                        FocusedBorderColor: =DataCardKey6_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =37
                        HoverBorderColor: =DataCardKey6_2.BorderColor
                        HoverColor: =DataCardKey6_2.Color
                        HoverFill: =DataCardKey6_2.Fill
                        PressedBorderColor: =DataCardKey6_2.BorderColor
                        PressedColor: =DataCardKey6_2.Color
                        PressedFill: =DataCardKey6_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =125
                        Wrap: =false
                        X: =15
                        Y: =9
                        ZIndex: =1

                    ErrorMessage6_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage6_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage6_2.BorderColor
                        HoverColor: =ErrorMessage6_2.Color
                        HoverFill: =ErrorMessage6_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage6_2.BorderColor
                        PressedColor: =ErrorMessage6_2.Color
                        PressedFill: =ErrorMessage6_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =
                        ZIndex: =3

                    DatePicker2_2 As datepicker:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        DefaultDate: =If(NewEstimate, Today(), ThisItem.DateCreated)
                        DisplayMode: =DisplayMode.View
                        FocusedBorderColor: =DatePicker2_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =DatePicker2_2.BorderColor
                        HoverFill: =DatePicker2_2.Fill
                        InputTextPlaceholder: =Text(Date(2001,12,31), DatePicker2_2.Format, DatePicker2_2.Language)
                        PaddingLeft: =90
                        PressedBorderColor: =DatePicker2_2.BorderColor
                        PressedFill: =DatePicker2_2.Fill
                        Size: =12
                        Width: =298
                        X: =128
                        Y: =12
                        ZIndex: =5

                ClientNumber_DataCard1 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="ClientNumber"
                    Default: =ThisItem.ClientNumber
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Client Number"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =59
                    MaxLength: =DataSourceInfo([@Estimates], DataSourceInfo.MaxLength, "ClientNumber")
                    Required: =false
                    Update: =DataCardValue3.Text
                    Width: =454
                    X: =0
                    Y: =1
                    ZIndex: =1

                    DataCardKey3 As label:
                        FocusedBorderColor: =DataCardKey3.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =33
                        HoverBorderColor: =DataCardKey3.BorderColor
                        HoverColor: =DataCardKey3.Color
                        HoverFill: =DataCardKey3.Fill
                        PressedBorderColor: =DataCardKey3.BorderColor
                        PressedColor: =DataCardKey3.Color
                        PressedFill: =DataCardKey3.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =127
                        Wrap: =false
                        X: =10
                        Y: =5
                        ZIndex: =1

                    DataCardValue3 As text:
                        Align: =Align.Center
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: |-
                            =ThisItem.ClientNumber
                            //LookUp(PJPROJ, project = DataCardValue1_2.Text, Trim(purchase_order_num))
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue3.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =DataCardValue3.HoverBorderColor
                        PressedColor: =DataCardValue3.Color
                        PressedFill: =DataCardValue3.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =262
                        X: =162
                        Y: =10
                        ZIndex: =2

                    ErrorMessage3 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage3.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage3.BorderColor
                        HoverColor: =ErrorMessage3.Color
                        HoverFill: =ErrorMessage3.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage3.BorderColor
                        PressedColor: =ErrorMessage3.Color
                        PressedFill: =ErrorMessage3.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue3.Y + DataCardValue3.Height
                        ZIndex: =3

                    StarVisible3 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible3.BorderColor
                        Height: =DataCardKey3.Height
                        HoverBorderColor: =StarVisible3.BorderColor
                        HoverColor: =StarVisible3.Color
                        HoverFill: =StarVisible3.Fill
                        PressedBorderColor: =StarVisible3.BorderColor
                        PressedColor: =StarVisible3.Color
                        PressedFill: =StarVisible3.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey3.Y
                        ZIndex: =4

                ProjectManager_DataCard1 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="ProjectManager"
                    Default: =ThisItem.ProjectManager
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Project Manager"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =41
                    MaxLength: =DataSourceInfo([@Estimates], DataSourceInfo.MaxLength, "ProjectManager")
                    Required: =false
                    Update: =DataCardValue111.Text
                    Width: =454
                    WidthFit: =false
                    X: =1
                    Y: =1
                    ZIndex: =1

                    DataCardKey113 As label:
                        FocusedBorderColor: =DataCardKey113.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =28
                        HoverBorderColor: =DataCardKey113.BorderColor
                        HoverColor: =DataCardKey113.Color
                        HoverFill: =DataCardKey113.Fill
                        PressedBorderColor: =DataCardKey113.BorderColor
                        PressedColor: =DataCardKey113.Color
                        PressedFill: =DataCardKey113.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =145
                        Wrap: =false
                        X: =10
                        Y: =10
                        ZIndex: =1

                    DataCardValue111 As text:
                        Align: =Align.Center
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: |-
                            =ThisItem.ProjectManager
                            //LookUp(PJPROJ, project = DataCardValue1_2.Text, Trim(manager1)) // dynamics DB Manager
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue111.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =DataCardValue111.HoverBorderColor
                        PressedColor: =DataCardValue111.Color
                        PressedFill: =DataCardValue111.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =280
                        X: =170
                        Y: =10
                        ZIndex: =2

                    ErrorMessage113 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage113.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage113.BorderColor
                        HoverColor: =ErrorMessage113.Color
                        HoverFill: =ErrorMessage113.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage113.BorderColor
                        PressedColor: =ErrorMessage113.Color
                        PressedFill: =ErrorMessage113.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue111.Y + DataCardValue111.Height
                        ZIndex: =3

                    StarVisible113 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible113.BorderColor
                        Height: =DataCardKey113.Height
                        HoverBorderColor: =StarVisible113.BorderColor
                        HoverColor: =StarVisible113.Color
                        HoverFill: =StarVisible113.Fill
                        PressedBorderColor: =StarVisible113.BorderColor
                        PressedColor: =StarVisible113.Color
                        PressedFill: =StarVisible113.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey113.Y
                        ZIndex: =4

                Designer_DataCard1 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Designer"
                    Default: =ThisItem.Designer
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Designer"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =59
                    MaxLength: =DataSourceInfo([@Estimates], DataSourceInfo.MaxLength, "Designer")
                    Required: =false
                    Update: =DataCardValue82.Text
                    Width: =454
                    X: =2
                    Y: =1
                    ZIndex: =1

                    DataCardKey83 As label:
                        FocusedBorderColor: =DataCardKey83.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =22
                        HoverBorderColor: =DataCardKey83.BorderColor
                        HoverColor: =DataCardKey83.Color
                        HoverFill: =DataCardKey83.Fill
                        PressedBorderColor: =DataCardKey83.BorderColor
                        PressedColor: =DataCardKey83.Color
                        PressedFill: =DataCardKey83.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =103
                        Wrap: =false
                        X: =15
                        Y: =10
                        ZIndex: =1

                    DataCardValue82 As text:
                        Align: =Align.Center
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: |-
                            =ThisItem.Designer
                            //LookUp(PJPROJ, project = DataCardValue1_2.Text, Trim(manager2))// dynamics DO Manager
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue82.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue82.HoverBorderColor
                        PressedColor: =DataCardValue82.Color
                        PressedFill: =DataCardValue82.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =298
                        X: =128
                        Y: =10
                        ZIndex: =2

                    ErrorMessage83 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage83.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage83.BorderColor
                        HoverColor: =ErrorMessage83.Color
                        HoverFill: =ErrorMessage83.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage83.BorderColor
                        PressedColor: =ErrorMessage83.Color
                        PressedFill: =ErrorMessage83.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue82.Y + DataCardValue82.Height
                        ZIndex: =3

                    StarVisible83 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible83.BorderColor
                        Height: =DataCardKey83.Height
                        HoverBorderColor: =StarVisible83.BorderColor
                        HoverColor: =StarVisible83.Color
                        HoverFill: =StarVisible83.Fill
                        PressedBorderColor: =StarVisible83.BorderColor
                        PressedColor: =StarVisible83.Color
                        PressedFill: =StarVisible83.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey83.Y
                        ZIndex: =4

                Stage_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Stage"
                    Default: =ThisItem.Stage
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Stage"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =49
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "Stage")
                    Required: =true
                    Update: =
                    Width: =454
                    X: =0
                    Y: =2
                    ZIndex: =1

                    DataCardKey3_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =DataCardKey3_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =34
                        HoverBorderColor: =DataCardKey3_2.BorderColor
                        HoverColor: =DataCardKey3_2.Color
                        HoverFill: =DataCardKey3_2.Fill
                        PressedBorderColor: =DataCardKey3_2.BorderColor
                        PressedColor: =DataCardKey3_2.Color
                        PressedFill: =DataCardKey3_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =77
                        Wrap: =false
                        X: =10
                        Y: =1
                        ZIndex: =1

                    ErrorMessage3_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage3_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage3_2.BorderColor
                        HoverColor: =ErrorMessage3_2.Color
                        HoverFill: =ErrorMessage3_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage3_2.BorderColor
                        PressedColor: =ErrorMessage3_2.Color
                        PressedFill: =ErrorMessage3_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =
                        ZIndex: =3

                    NewEstStage_2 As dropdown:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        ChevronBackground: =RGBA(36, 76, 90, 1)
                        ChevronHoverBackground: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        Default: =ThisItem.Stage
                        DisplayMode: =If(FirstSaveOnNewEstimate, DisplayMode.View,Parent.DisplayMode)
                        FocusedBorderColor: =NewEstStage_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =ColorFade(NewEstStage_2.BorderColor, 15%)
                        Items: =["Quote", "IFR", "IFC", "Ball Park"]
                        OnChange: |-
                            =If(Trim(DataCardValue1_2.Text) = "",
                             UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                             If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  
                                                    Type = DataCardValue2_2.Text),
                            	UpdateContext({NewEstPopUp:true, 
                                                NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                            					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                                 Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true}),
                            					 false)
                            )
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =NewEstStage_2.HoverBorderColor
                        PressedFill: =RGBA(36, 76, 90, 1)
                        SelectionFill: =RGBA(36, 76, 90, 1)
                        Size: =12
                        Width: =262
                        X: =162
                        Y: =10
                        ZIndex: =5

                Version_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Version"
                    Default: =ThisItem.Version
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Version"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =36
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "Version")
                    Required: =true
                    Update: =
                    Width: =454
                    X: =1
                    Y: =2
                    ZIndex: =1

                    DataCardKey4_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =DataCardKey4_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =30
                        HoverBorderColor: =DataCardKey4_2.BorderColor
                        HoverColor: =DataCardKey4_2.Color
                        HoverFill: =DataCardKey4_2.Fill
                        PressedBorderColor: =DataCardKey4_2.BorderColor
                        PressedColor: =DataCardKey4_2.Color
                        PressedFill: =DataCardKey4_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =77
                        Wrap: =false
                        X: =10
                        Y: =9
                        ZIndex: =1

                    ErrorMessage4_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage4_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage4_2.BorderColor
                        HoverColor: =ErrorMessage4_2.Color
                        HoverFill: =ErrorMessage4_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage4_2.BorderColor
                        PressedColor: =ErrorMessage4_2.Color
                        PressedFill: =ErrorMessage4_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =60
                        ZIndex: =3

                    NewEstVersion_2 As dropdown:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        ChevronBackground: =RGBA(36, 76, 90, 1)
                        ChevronHoverBackground: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        Default: =ThisItem.Version
                        DisplayMode: =If(FirstSaveOnNewEstimate, DisplayMode.View,Parent.DisplayMode)
                        FocusedBorderColor: =NewEstVersion_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =ColorFade(NewEstVersion_2.BorderColor, 15%)
                        Items: =["REV 0", "REV 1", "REV 2", "REV 3", "REV 4", "REV 5"]
                        OnChange: |-
                            =If(Trim(DataCardValue1_2.Text) = "",
                             UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                             If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  
                                                    Type = DataCardValue2_2.Text),
                            	UpdateContext({NewEstPopUp:true, 
                                                NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                            					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                                 Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true}),
                            					 false)
                            )
                        PressedBorderColor: =NewEstVersion_2.HoverBorderColor
                        PressedFill: =RGBA(36, 76, 90, 1)
                        SelectionFill: =RGBA(36, 76, 90, 1)
                        Size: =12
                        Width: =276
                        X: =170
                        Y: =10
                        ZIndex: =5

                Type_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Type"
                    Default: =ThisItem.Type
                    DisplayMode: =DisplayMode.View
                    DisplayName: ="Type"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =48
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "Type")
                    Required: =true
                    Update: =DataCardValue2_2.Text
                    Width: =454
                    X: =2
                    Y: =2
                    ZIndex: =1

                    DataCardKey2_2 As label:
                        FocusedBorderColor: =DataCardKey2_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =34
                        HoverBorderColor: =DataCardKey2_2.BorderColor
                        HoverColor: =DataCardKey2_2.Color
                        HoverFill: =DataCardKey2_2.Fill
                        PressedBorderColor: =DataCardKey2_2.BorderColor
                        PressedColor: =DataCardKey2_2.Color
                        PressedFill: =DataCardKey2_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =54
                        Wrap: =false
                        X: =15
                        Y: =9
                        ZIndex: =1

                    DataCardValue2_2 As text:
                        Align: =Align.Center
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =If(NewEstimate, NewEstimateType, CurrentEstimateType)
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue2_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =26
                        HoverFill: =RGBA(255, 255, 255, 1)
                        MaxLength: =Parent.MaxLength
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue2_2.HoverBorderColor
                        PressedColor: =DataCardValue2_2.Color
                        PressedFill: =DataCardValue2_2.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =298
                        X: =128
                        Y: =15
                        ZIndex: =2

                    ErrorMessage2_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage2_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage2_2.BorderColor
                        HoverColor: =ErrorMessage2_2.Color
                        HoverFill: =ErrorMessage2_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage2_2.BorderColor
                        PressedColor: =ErrorMessage2_2.Color
                        PressedFill: =ErrorMessage2_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue2_2.Y + DataCardValue2_2.Height
                        ZIndex: =3

                    StarVisible2_2 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible2_2.BorderColor
                        Height: =DataCardKey2_2.Height
                        HoverBorderColor: =StarVisible2_2.BorderColor
                        HoverColor: =StarVisible2_2.Color
                        HoverFill: =StarVisible2_2.Fill
                        PressedBorderColor: =StarVisible2_2.BorderColor
                        PressedColor: =StarVisible2_2.Color
                        PressedFill: =StarVisible2_2.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey2_2.Y
                        ZIndex: =4

                MaterialSupplier_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="MaterialSupplier"
                    Default: =ThisItem.MaterialSupplier
                    DisplayMode: =DisplayMode.Edit
                    DisplayName: |-
                        ="Material 
                        Supplier"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =65
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "MaterialSupplier")
                    Required: =false
                    Update: =NewEstMatSupplier_2.Selected.VendorName
                    Width: =454
                    X: =0
                    Y: =3
                    ZIndex: =1

                    DataCardKey8_2 As label:
                        FocusedBorderColor: =DataCardKey8_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =52
                        HoverBorderColor: =DataCardKey8_2.BorderColor
                        HoverColor: =DataCardKey8_2.Color
                        HoverFill: =DataCardKey8_2.Fill
                        PressedBorderColor: =DataCardKey8_2.BorderColor
                        PressedColor: =DataCardKey8_2.Color
                        PressedFill: =DataCardKey8_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        VerticalAlign: =VerticalAlign.Top
                        Width: =85
                        Wrap: =false
                        X: =10
                        Y: =10
                        ZIndex: =1

                    ErrorMessage8_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage8_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage8_2.BorderColor
                        HoverColor: =ErrorMessage8_2.Color
                        HoverFill: =ErrorMessage8_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage8_2.BorderColor
                        PressedColor: =ErrorMessage8_2.Color
                        PressedFill: =ErrorMessage8_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        ZIndex: =3

                    StarVisible8_2 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible8_2.BorderColor
                        Height: =DataCardKey8_2.Height
                        HoverBorderColor: =StarVisible8_2.BorderColor
                        HoverColor: =StarVisible8_2.Color
                        HoverFill: =StarVisible8_2.Fill
                        PressedBorderColor: =StarVisible8_2.BorderColor
                        PressedColor: =StarVisible8_2.Color
                        PressedFill: =StarVisible8_2.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey8_2.Y
                        ZIndex: =4

                    NewEstMatSupplier_2 As dropdown:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        ChevronBackground: =RGBA(36, 76, 90, 1)
                        ChevronHoverBackground: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        Default: |
                            =/*If( NewEstimateType in ["Enmax", "Fortis Alberta", "City of Calgary"] Or CurrentEstimateType in ["Enmax", "Fortis Alberta", "City of Calgary"],
                                ThisItem.MaterialSupplier,
                                "City of Calgary"
                            )*/
                            ThisItem.MaterialSupplier
                        DisplayMode: |-
                            =/*If( NewEstimateType in ["Enmax", "Fortis Alberta"] Or CurrentEstimateType in ["Enmax", "Fortis Alberta"],
                                DisplayMode.Edit,
                                View
                            )*/DisplayMode.Edit
                        FocusedBorderColor: =NewEstMatSupplier_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =32
                        HoverBorderColor: =ColorFade(NewEstMatSupplier_2.BorderColor, 15%)
                        Items: =VendorList.VendorName
                        PressedBorderColor: =NewEstMatSupplier_2.HoverBorderColor
                        PressedFill: =RGBA(36, 76, 90, 1)
                        SelectionFill: =RGBA(36, 76, 90, 1)
                        Size: =12
                        Width: =262
                        X: =162
                        Y: =18
                        ZIndex: =5

                Contractor_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Contractor"
                    Default: =ThisItem.Contractor
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Contractor"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =60
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "Contractor")
                    Required: =false
                    Update: =NewEstLabContractor_2.Selected.ContractorName
                    Width: =454
                    X: =1
                    Y: =3
                    ZIndex: =1

                    DataCardKey7_2 As label:
                        FocusedBorderColor: =DataCardKey7_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =25
                        HoverBorderColor: =DataCardKey7_2.BorderColor
                        HoverColor: =DataCardKey7_2.Color
                        HoverFill: =DataCardKey7_2.Fill
                        PressedBorderColor: =DataCardKey7_2.BorderColor
                        PressedColor: =DataCardKey7_2.Color
                        PressedFill: =DataCardKey7_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =142
                        Wrap: =false
                        X: =11
                        Y: =12
                        ZIndex: =1

                    ErrorMessage7_2 As label:
                        FocusedBorderColor: =ErrorMessage7_2.BorderColor
                        Height: =26
                        HoverBorderColor: =ErrorMessage7_2.BorderColor
                        HoverColor: =ErrorMessage7_2.Color
                        HoverFill: =ErrorMessage7_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage7_2.BorderColor
                        PressedColor: =ErrorMessage7_2.Color
                        PressedFill: =ErrorMessage7_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =323
                        X: =105
                        Y: =52
                        ZIndex: =3

                    StarVisible7_2 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible7_2.BorderColor
                        Height: =DataCardKey7_2.Height
                        HoverBorderColor: =StarVisible7_2.BorderColor
                        HoverColor: =StarVisible7_2.Color
                        HoverFill: =StarVisible7_2.Fill
                        PressedBorderColor: =StarVisible7_2.BorderColor
                        PressedColor: =StarVisible7_2.Color
                        PressedFill: =StarVisible7_2.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey7_2.Y
                        ZIndex: =4

                    NewEstLabContractor_2 As dropdown:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        ChevronBackground: =RGBA(36, 76, 90, 1)
                        ChevronHoverBackground: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        Default: =ThisItem.Contractor
                        FocusedBorderColor: =NewEstLabContractor_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =34
                        HoverBorderColor: =ColorFade(NewEstLabContractor_2.BorderColor, 15%)
                        Items: =ContractorList.ContractorName
                        PressedBorderColor: =NewEstLabContractor_2.HoverBorderColor
                        PressedFill: =RGBA(36, 76, 90, 1)
                        SelectionFill: =RGBA(36, 76, 90, 1)
                        Size: =12
                        Width: =280
                        X: =165
                        Y: =18
                        ZIndex: =5

                Description_DataCard1_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Description"
                    Default: =ThisItem.Description
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Description"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =65
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "Description")
                    Required: =false
                    Update: =DataCardValue5_2.Text
                    Width: =454
                    X: =2
                    Y: =3
                    ZIndex: =1

                    DataCardKey5_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =DataCardKey5_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =34
                        HoverBorderColor: =DataCardKey5_2.BorderColor
                        HoverColor: =DataCardKey5_2.Color
                        HoverFill: =DataCardKey5_2.Fill
                        PressedBorderColor: =DataCardKey5_2.BorderColor
                        PressedColor: =DataCardKey5_2.Color
                        PressedFill: =DataCardKey5_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =120
                        Wrap: =false
                        X: =15
                        Y: =18
                        ZIndex: =1

                    DataCardValue5_2 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: |-
                            =ThisItem.Description
                            //LookUp(PJPROJ, project = DataCardValue1_2.Text, Trim(project_desc))
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue5_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =50
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        PressedBorderColor: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        PressedColor: =DataCardValue5_2.Color
                        PressedFill: =DataCardValue5_2.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =298
                        X: =128
                        Y: =18
                        ZIndex: =2

                    ErrorMessage5_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage5_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage5_2.BorderColor
                        HoverColor: =ErrorMessage5_2.Color
                        HoverFill: =ErrorMessage5_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage5_2.BorderColor
                        PressedColor: =ErrorMessage5_2.Color
                        PressedFill: =ErrorMessage5_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue5_2.Y + DataCardValue5_2.Height
                        ZIndex: =3

                    StarVisible5_2 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible5_2.BorderColor
                        Height: =DataCardKey5_2.Height
                        HoverBorderColor: =StarVisible5_2.BorderColor
                        HoverColor: =StarVisible5_2.Color
                        HoverFill: =StarVisible5_2.Fill
                        PressedBorderColor: =StarVisible5_2.BorderColor
                        PressedColor: =StarVisible5_2.Color
                        PressedFill: =StarVisible5_2.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey5_2.Y
                        ZIndex: =4

                Address_DataCard1 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Address"
                    Default: =ThisItem.Address
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Address"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =131
                    MaxLength: =DataSourceInfo([@Estimates], DataSourceInfo.MaxLength, "Address")
                    Required: =false
                    Update: =DataCardValue4.Text
                    Width: =454
                    X: =0
                    Y: =4
                    ZIndex: =1

                    DataCardKey4 As label:
                        FocusedBorderColor: =DataCardKey4.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =39
                        HoverBorderColor: =DataCardKey4.BorderColor
                        HoverColor: =DataCardKey4.Color
                        HoverFill: =DataCardKey4.Fill
                        PressedBorderColor: =DataCardKey4.BorderColor
                        PressedColor: =DataCardKey4.Color
                        PressedFill: =DataCardKey4.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =86
                        Wrap: =false
                        X: =10
                        Y: =10
                        ZIndex: =1

                    DataCardValue4 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: |-
                            =ThisItem.Address
                            //LookUp(PJPROJ, project = DataCardValue1_2.Text, Trim(pm_id02))
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue4.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =90
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue4.HoverBorderColor
                        PressedColor: =DataCardValue4.Color
                        PressedFill: =DataCardValue4.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =262
                        X: =162
                        Y: =10
                        ZIndex: =2

                    ErrorMessage4 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage4.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage4.BorderColor
                        HoverColor: =ErrorMessage4.Color
                        HoverFill: =ErrorMessage4.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage4.BorderColor
                        PressedColor: =ErrorMessage4.Color
                        PressedFill: =ErrorMessage4.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue4.Y + DataCardValue4.Height
                        ZIndex: =3

                    StarVisible4 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible4.BorderColor
                        Height: =DataCardKey4.Height
                        HoverBorderColor: =StarVisible4.BorderColor
                        HoverColor: =StarVisible4.Color
                        HoverFill: =StarVisible4.Fill
                        PressedBorderColor: =StarVisible4.BorderColor
                        PressedColor: =StarVisible4.Color
                        PressedFill: =StarVisible4.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey4.Y
                        ZIndex: =4

                Notes_DataCard5_2 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Notes"
                    Default: =ThisItem.Notes
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: ="Notes"
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =112
                    MaxLength: =DataSourceInfo(Estimates, DataSourceInfo.MaxLength, "Notes")
                    Required: =false
                    Update: =DataCardValue3_2.Text
                    Width: =454
                    X: =1
                    Y: =4
                    ZIndex: =1

                    DataCardKey10_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =DataCardKey10_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =34
                        HoverBorderColor: =DataCardKey10_2.BorderColor
                        HoverColor: =DataCardKey10_2.Color
                        HoverFill: =DataCardKey10_2.Fill
                        PressedBorderColor: =DataCardKey10_2.BorderColor
                        PressedColor: =DataCardKey10_2.Color
                        PressedFill: =DataCardKey10_2.Fill
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =96
                        Wrap: =false
                        X: =10
                        Y: =10
                        ZIndex: =1

                    DataCardValue3_2 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =ThisItem.Notes
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        FocusedBorderColor: =DataCardValue3_2.BorderColor
                        Font: =Font.'Lato Light'
                        Height: =150
                        HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                        MaxLength: =Parent.MaxLength
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue3_2.HoverBorderColor
                        PressedColor: =DataCardValue3_2.Color
                        PressedFill: =DataCardValue3_2.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =280
                        X: =170
                        Y: =12
                        ZIndex: =2

                    ErrorMessage10_2 As label:
                        AutoHeight: =true
                        FocusedBorderColor: =ErrorMessage10_2.BorderColor
                        Height: =10
                        HoverBorderColor: =ErrorMessage10_2.BorderColor
                        HoverColor: =ErrorMessage10_2.Color
                        HoverFill: =ErrorMessage10_2.Fill
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        PressedBorderColor: =ErrorMessage10_2.BorderColor
                        PressedColor: =ErrorMessage10_2.Color
                        PressedFill: =ErrorMessage10_2.Fill
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue3_2.Y + DataCardValue3_2.Height
                        ZIndex: =3

                    StarVisible10_2 As label:
                        Align: =Align.Center
                        FocusedBorderColor: =StarVisible10_2.BorderColor
                        Height: =DataCardKey10_2.Height
                        HoverBorderColor: =StarVisible10_2.BorderColor
                        HoverColor: =StarVisible10_2.Color
                        HoverFill: =StarVisible10_2.Fill
                        PressedBorderColor: =StarVisible10_2.BorderColor
                        PressedColor: =StarVisible10_2.Color
                        PressedFill: =StarVisible10_2.Fill
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey10_2.Y
                        ZIndex: =4

                siteID_DataCard1 As typedDataCard.textualEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="siteID"
                    Default: =ThisItem.siteID
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Estimates],DataSourceInfo.DisplayName,"siteID")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    MaxLength: =DataSourceInfo([@Estimates], DataSourceInfo.MaxLength, "siteID")
                    Required: =false
                    Update: =Dropdown21.Selected.Value
                    Width: =454
                    X: =2
                    Y: =4
                    ZIndex: =1

                    DataCardKey147 As label:
                        Font: =Font.'Lato Light'
                        Height: =38
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =76
                        Wrap: =false
                        X: =15
                        Y: =42
                        ZIndex: =1

                    DataCardValue145 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        Height: =21
                        MaxLength: =Parent.MaxLength
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue145.HoverBorderColor
                        PressedColor: =DataCardValue145.Color
                        PressedFill: =DataCardValue145.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =Parent.DisplayName
                        Width: =201
                        X: =156
                        Y: =59
                        ZIndex: =2

                    ErrorMessage147 As label:
                        AutoHeight: =true
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue145.Y + DataCardValue145.Height
                        ZIndex: =3

                    StarVisible147 As label:
                        Align: =Align.Center
                        Height: =DataCardKey147.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey147.Y
                        ZIndex: =4

                    Dropdown21 As dropdown:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        ChevronBackground: =RGBA(36, 76, 90, 1)
                        ChevronHoverBackground: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        Default: =ThisItem.siteID
                        Height: =32
                        HoverBorderColor: =ColorFade(Dropdown21.BorderColor, 15%)
                        Items: =["WHSE", "BURNABY", "EDMONTON", "KELOWNA", "REGINA", "SASKATOON", "VICTORIA", "WINNIPEG"]
                        PressedBorderColor: =Dropdown21.HoverBorderColor
                        PressedFill: =RGBA(36, 76, 90, 1)
                        SelectionFill: =RGBA(36, 76, 90, 1)
                        Width: =298
                        X: =128
                        Y: =58
                        ZIndex: =5

                department_DataCard1 As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(36, 76, 90, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="department"
                    Default: =ThisItem.department
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Estimates],DataSourceInfo.DisplayName,"department")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =50
                    MaxLength: =DataSourceInfo([@Estimates], DataSourceInfo.MaxLength, "department")
                    Required: =false
                    Update: =Dropdown26.Selected.Value
                    Width: =454
                    X: =0
                    Y: =5
                    ZIndex: =1

                    DataCardKey148 As label:
                        Font: =Font.'Lato Light'
                        Height: =34
                        Size: =12
                        Text: =Parent.DisplayName
                        Width: =104
                        Wrap: =false
                        X: =10
                        Y: =20
                        ZIndex: =1

                    DataCardValue146 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisplayMode: =Parent.DisplayMode
                        Height: =16
                        MaxLength: =Parent.MaxLength
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue146.HoverBorderColor
                        PressedColor: =DataCardValue146.Color
                        PressedFill: =DataCardValue146.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =Parent.DisplayName
                        Width: =235
                        X: =175
                        Y: =28
                        ZIndex: =2

                    ErrorMessage148 As label:
                        AutoHeight: =true
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue146.Y + DataCardValue146.Height
                        ZIndex: =3

                    StarVisible148 As label:
                        Align: =Align.Center
                        Height: =DataCardKey148.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey148.Y
                        ZIndex: =4

                    Dropdown26 As dropdown:
                        BorderColor: =RGBA(36, 76, 90, 1)
                        ChevronBackground: =RGBA(36, 76, 90, 1)
                        ChevronHoverBackground: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                        Default: =ThisItem.department
                        Height: =32
                        HoverBorderColor: =ColorFade(Dropdown26.BorderColor, 15%)
                        Items: =["112", "116", "311"]
                        PressedBorderColor: =Dropdown26.HoverBorderColor
                        PressedFill: =RGBA(36, 76, 90, 1)
                        SelectionFill: =RGBA(36, 76, 90, 1)
                        Width: =262
                        X: =162
                        Y: =20
                        ZIndex: =5

                constrDays_DataCard1 As typedDataCard.numberEditCard:
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="constrDays"
                    Default: =ThisItem.constrDays
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@Estimates],DataSourceInfo.DisplayName,"constrDays")
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =62
                    Required: =false
                    Update: =Value(DataCardValue153.Text)
                    Width: =454
                    X: =1
                    Y: =5
                    ZIndex: =1

                    DataCardKey155 As label:
                        Font: =Font.'Lato Light'
                        Height: =50
                        Size: =12
                        Text: ="Construction Days"
                        Width: =174
                        Wrap: =false
                        Y: =10
                        ZIndex: =1

                    DataCardValue153 As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisplayMode: =DisplayMode.View
                        Format: =TextFormat.Number
                        PaddingLeft: =5
                        PressedBorderColor: =DataCardValue153.HoverBorderColor
                        PressedColor: =DataCardValue153.Color
                        PressedFill: =DataCardValue153.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Tooltip: =Parent.DisplayName
                        Width: =260
                        X: =142
                        Y: =15
                        ZIndex: =2

                    ErrorMessage155 As label:
                        AutoHeight: =true
                        Height: =10
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =Parent.Error
                        Visible: =Parent.DisplayMode=DisplayMode.Edit
                        Width: =Parent.Width - 60
                        X: =30
                        Y: =DataCardValue153.Y + DataCardValue153.Height
                        ZIndex: =3

                    StarVisible155 As label:
                        Align: =Align.Center
                        Height: =DataCardKey155.Height
                        Text: ="*"
                        Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                        Width: =30
                        Wrap: =false
                        Y: =DataCardKey155.Y
                        ZIndex: =4

            Label51 As label:
                Color: =RGBA(184, 0, 0, 1)
                FocusedBorderColor: =Label51.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =74
                HoverBorderColor: =Label51.BorderColor
                HoverColor: =Label51.Color
                HoverFill: =Label51.Fill
                PressedBorderColor: =Label51.BorderColor
                PressedColor: =Label51.Color
                PressedFill: =Label51.Fill
                Size: =14
                Text: ="Please SAVE your work before moving on to next section"
                Visible: =false//Not(FirstSaveOnNewEstimate)
                Width: =415
                X: =928
                Y: =384
                ZIndex: =2

        AddEstimateComponents As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =497
            Width: =1366
            X: =0
            Y: =1
            ZIndex: =2

            Structures_2 As button:
                BorderColor: =ColorFade(Structures_2.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =Structures_2.BorderColor
                Height: =44
                HoverBorderColor: =ColorFade(Structures_2.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    //when page starts, make 8 vars. if fortis, contingency_percentage
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddStructToEst, ScreenTransition.Fade, {NewEstimateVendor:NewEstMatSupplier_2.Selected.VendorName,
                                                    NewEstimateContractor:NewEstLabContractor_2.Selected.ContractorName, 
                                                    NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddStructToEst, ScreenTransition.Fade, {NewEstimateVendor:NewEstMatSupplier_2.Selected.VendorName,
                                                    NewEstimateContractor:NewEstLabContractor_2.Selected.ContractorName, 
                                                    NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Structures_2.Fill
                PressedColor: =Structures_2.Fill
                PressedFill: =Structures_2.Color
                Text: ="Add Structures"
                Width: =225
                X: =40
                Y: =26
                ZIndex: =1

            Materials_2 As button:
                BorderColor: =ColorFade(Materials_2.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =Materials_2.BorderColor
                Height: =44
                HoverBorderColor: =ColorFade(Materials_2.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddMaterialsToEst, ScreenTransition.Fade, {NewEstimateVendor:NewEstMatSupplier_2.Selected.VendorName,
                                                    NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddMaterialsToEst, ScreenTransition.Fade, {NewEstimateVendor:NewEstMatSupplier_2.Selected.VendorName,
                                                    NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Materials_2.Fill
                PressedColor: =Materials_2.Fill
                PressedFill: =Materials_2.Color
                Text: ="Add Materials"
                Width: =225
                X: =40
                Y: =84
                ZIndex: =2

            Labour_2 As button:
                BorderColor: =ColorFade(Labour_2.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =Labour_2.BorderColor
                Height: =44
                HoverBorderColor: =ColorFade(Labour_2.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(And(CurrentEstimateType = "Fortis Alberta", NewEstimate = false),
                        Set(myConstrDays,Value(DataCardValue153.Text)),
                        0;
                    );
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */ 
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddLabourToEst, ScreenTransition.Fade, {NewEstimateContractor:NewEstLabContractor_2.Selected.ContractorName, 
                                                    NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddLabourToEst, ScreenTransition.Fade, {NewEstimateContractor:NewEstLabContractor_2.Selected.ContractorName, 
                                                    NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Labour_2.Fill
                PressedColor: =Labour_2.Fill
                PressedFill: =Labour_2.Color
                Text: ="Add Labour"
                Width: =225
                X: =40
                Y: =138
                ZIndex: =3

            Permits_2 As button:
                BorderColor: =ColorFade(Permits_2.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =Permits_2.BorderColor
                Height: =44
                HoverBorderColor: =ColorFade(Permits_2.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddPermitsToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddPermitsToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Permits_2.Fill
                PressedColor: =Permits_2.Fill
                PressedFill: =Permits_2.Color
                Text: ="Add Pemits"
                Width: =225
                X: =40
                Y: =195
                ZIndex: =4

            ExtraCosts_2 As button:
                BorderColor: =ColorFade(ExtraCosts_2.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =ExtraCosts_2.BorderColor
                Height: =44
                HoverBorderColor: =ColorFade(ExtraCosts_2.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddExtraCostItemsToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddExtraCostItemsToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =ExtraCosts_2.Fill
                PressedColor: =ExtraCosts_2.Fill
                PressedFill: =ExtraCosts_2.Color
                Text: ="Extra Cost Items"
                Width: =225
                X: =40
                Y: =247
                ZIndex: =7

            Label45_14 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_14.BorderColor
                Height: =28
                HoverBorderColor: =Label45_14.BorderColor
                HoverColor: =Label45_14.Color
                HoverFill: =Label45_14.Fill
                PressedBorderColor: =Label45_14.BorderColor
                PressedColor: =Label45_14.Color
                PressedFill: =Label45_14.Fill
                Text: |-
                    ="Material Cost:"
                X: =326
                Y: =32
                ZIndex: =8

            Label45_16 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_16.BorderColor
                Height: =24
                HoverBorderColor: =Label45_16.BorderColor
                HoverColor: =Label45_16.Color
                HoverFill: =Label45_16.Fill
                PressedBorderColor: =Label45_16.BorderColor
                PressedColor: =Label45_16.Color
                PressedFill: =Label45_16.Fill
                Text: |-
                    ="Material Cost:"
                X: =326
                Y: =88
                ZIndex: =9

            Label45_17 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_17.BorderColor
                Height: =23
                HoverBorderColor: =Label45_17.BorderColor
                HoverColor: =Label45_17.Color
                HoverFill: =Label45_17.Fill
                PressedBorderColor: =Label45_17.BorderColor
                PressedColor: =Label45_17.Color
                PressedFill: =Label45_17.Fill
                Text: |-
                    ="Labour Cost:"
                Width: =115
                X: =773
                Y: =151
                ZIndex: =10

            Label45_15 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_15.BorderColor
                Height: =28
                HoverBorderColor: =Label45_15.BorderColor
                HoverColor: =Label45_15.Color
                HoverFill: =Label45_15.Fill
                PressedBorderColor: =Label45_15.BorderColor
                PressedColor: =Label45_15.Color
                PressedFill: =Label45_15.Fill
                Text: |-
                    ="Labour Cost:"
                Width: =115
                X: =773
                Y: =32
                ZIndex: =11

            Label45_19 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_19.BorderColor
                Height: =21
                HoverBorderColor: =Label45_19.BorderColor
                HoverColor: =Label45_19.Color
                HoverFill: =Label45_19.Fill
                PressedBorderColor: =Label45_19.BorderColor
                PressedColor: =Label45_19.Color
                PressedFill: =Label45_19.Fill
                Text: |-
                    ="Cost:"
                X: =326
                Y: =247
                ZIndex: =13

            Label45_18 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_18.BorderColor
                Height: =24
                HoverBorderColor: =Label45_18.BorderColor
                HoverColor: =Label45_18.Color
                HoverFill: =Label45_18.Fill
                PressedBorderColor: =Label45_18.BorderColor
                PressedColor: =Label45_18.Color
                PressedFill: =Label45_18.Fill
                Text: |-
                    ="Cost:"
                X: =326
                Y: =201
                ZIndex: =14

            EstStrucMatCost_2 As label:
                FocusedBorderColor: =EstStrucMatCost_2.BorderColor
                Height: =28
                HoverBorderColor: =EstStrucMatCost_2.BorderColor
                HoverColor: =EstStrucMatCost_2.Color
                HoverFill: =EstStrucMatCost_2.Fill
                PressedBorderColor: =EstStrucMatCost_2.BorderColor
                PressedColor: =EstStrucMatCost_2.Color
                PressedFill: =EstStrucMatCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Struc_M_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Struc_M_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =476
                Y: =32
                ZIndex: =15

            EstStrucLabCost_2 As label:
                FocusedBorderColor: =EstStrucLabCost_2.BorderColor
                Height: =28
                HoverBorderColor: =EstStrucLabCost_2.BorderColor
                HoverColor: =EstStrucLabCost_2.Color
                HoverFill: =EstStrucLabCost_2.Fill
                PressedBorderColor: =EstStrucLabCost_2.BorderColor
                PressedColor: =EstStrucLabCost_2.Color
                PressedFill: =EstStrucLabCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Struc_L_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Struc_L_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =903
                Y: =32
                ZIndex: =16

            EstMatCost_2 As label:
                FocusedBorderColor: =EstMatCost_2.BorderColor
                Height: =24
                HoverBorderColor: =EstMatCost_2.BorderColor
                HoverColor: =EstMatCost_2.Color
                HoverFill: =EstMatCost_2.Fill
                PressedBorderColor: =EstMatCost_2.BorderColor
                PressedColor: =EstMatCost_2.Color
                PressedFill: =EstMatCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Material_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Material_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =476
                Y: =88
                ZIndex: =17

            EstLabCost_2 As label:
                FocusedBorderColor: =EstLabCost_2.BorderColor
                Height: =23
                HoverBorderColor: =EstLabCost_2.BorderColor
                HoverColor: =EstLabCost_2.Color
                HoverFill: =EstLabCost_2.Fill
                PressedBorderColor: =EstLabCost_2.BorderColor
                PressedColor: =EstLabCost_2.Color
                PressedFill: =EstLabCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Labour_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Labour_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =903
                Y: =151
                ZIndex: =18

            EstPermitMatCost_2 As label:
                FocusedBorderColor: =EstPermitMatCost_2.BorderColor
                Height: =24
                HoverBorderColor: =EstPermitMatCost_2.BorderColor
                HoverColor: =EstPermitMatCost_2.Color
                HoverFill: =EstPermitMatCost_2.Fill
                PressedBorderColor: =EstPermitMatCost_2.BorderColor
                PressedColor: =EstPermitMatCost_2.Color
                PressedFill: =EstPermitMatCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Permit_M_Cost + Permit_L_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Permit_M_Cost + Permit_L_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =476
                Y: =201
                ZIndex: =19

            EstXtraMatCost_2 As label:
                FocusedBorderColor: =EstXtraMatCost_2.BorderColor
                Height: =21
                HoverBorderColor: =EstXtraMatCost_2.BorderColor
                HoverColor: =EstXtraMatCost_2.Color
                HoverFill: =EstXtraMatCost_2.Fill
                PressedBorderColor: =EstXtraMatCost_2.BorderColor
                PressedColor: =EstXtraMatCost_2.Color
                PressedFill: =EstXtraMatCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Extra_M_Cost + Extra_L_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Extra_M_Cost + Extra_L_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =476
                Y: =247
                ZIndex: =20

            Button16 As button:
                BorderColor: =ColorFade(Button16.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                Height: =44
                HoverBorderColor: =ColorFade(Button16.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddEngToEst,ScreenTransition.Fade,{NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddEngToEst,ScreenTransition.Fade,{NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Button16.Fill
                PressedColor: =Button16.Fill
                PressedFill: =Button16.Color
                Text: ="Add Engineering Cost"
                Width: =225
                X: =40
                Y: =302
                ZIndex: =21

            Label45_20 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_20.BorderColor
                Height: =37
                HoverBorderColor: =Label45_20.BorderColor
                HoverColor: =Label45_20.Color
                HoverFill: =Label45_20.Fill
                PressedBorderColor: =Label45_20.BorderColor
                PressedColor: =Label45_20.Color
                PressedFill: =Label45_20.Fill
                Text: |-
                    ="Cost:"
                Width: =85
                X: =326
                Y: =309
                ZIndex: =22

            Button17 As button:
                BorderColor: =ColorFade(Button17.Fill, -15%)
                DisplayMode: |-
                    =DisplayMode.Edit/*If( NewEstimateType in ["Enmax", "Fortis Alberta"] Or CurrentEstimateType in ["Enmax", "Fortis Alberta"],
                        DisplayMode.Edit,
                        Disabled
                    )*/
                Fill: =RGBA(36, 76, 90, 1)
                Height: =46
                HoverBorderColor: =ColorFade(Button17.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            // Enmax and City
                            Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text))
                            /*Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  */
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddEPCInvesmentToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddEPCInvesmentToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Button17.Fill
                PressedColor: =Button17.Fill
                PressedFill: =Button17.Color
                Text: |-
                    ="Add EPC Investment
                    & Cost"
                Width: =225
                X: =40
                Y: =363
                ZIndex: =23

            Label45_21 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_21.BorderColor
                Height: =37
                HoverBorderColor: =Label45_21.BorderColor
                HoverColor: =Label45_21.Color
                HoverFill: =Label45_21.Fill
                PressedBorderColor: =Label45_21.BorderColor
                PressedColor: =Label45_21.Color
                PressedFill: =Label45_21.Fill
                Text: |-
                    ="Cost:"
                Width: =85
                X: =326
                Y: =363
                ZIndex: =24

            EstEPCCost_2 As label:
                FocusedBorderColor: =EstEPCCost_2.BorderColor
                Height: =23
                HoverBorderColor: =EstEPCCost_2.BorderColor
                HoverColor: =EstEPCCost_2.Color
                HoverFill: =EstEPCCost_2.Fill
                PressedBorderColor: =EstEPCCost_2.BorderColor
                PressedColor: =EstEPCCost_2.Color
                PressedFill: =EstEPCCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(EPC_Sec_TotalCost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(EPC_Sec_TotalCost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =476
                Y: =377
                ZIndex: =25

            EstEngTotalCost_2 As label:
                Height: =44
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Eng_P_Cost + Eng_D_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Eng_P_Cost + Eng_D_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =123
                X: =476
                Y: =302
                ZIndex: =26

            Button17_1 As button:
                BorderColor: =ColorFade(Button17_1.Fill, -15%)
                DisplayMode: |-
                    =If( NewEstimateType in ["Enmax", "Fortis Alberta"] Or CurrentEstimateType in ["Enmax", "Fortis Alberta"],
                        DisplayMode.Edit,
                        DisplayMode.Disabled
                    )
                Fill: =RGBA(36, 76, 90, 1)
                Height: =46
                HoverBorderColor: =ColorFade(Button17_1.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version, Estimate type)
                    If(NewEstimateType = "Fortis Alberta",
                           Set(m_Markup, Value(estMarkPercentageMTask.Text)); Set(m_contingency, Value(estConPercentageMTask.Text));
                            Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentageXTask.Text)); Set(x_contingency, Value(estConPercentageXTask.Text));
                            Set(c_Markup,  Value(estMarkPercentageCTask.Text)); Set(c_contingency, Value(estConPercentageCTask.Text)),
                            // Enmax and City
                            Set(m_Markup,Value(estMarkPercentage.Text)); Set(m_contingency, Value(estConPercentage.Text));
                             Set(e_Markup, Value(estMarkPercentage.Text)); Set(e_contingency, Value(estConPercentage.Text));
                            Set(x_Markup, Value(estMarkPercentage.Text)); Set(x_contingency, Value(estConPercentage.Text));
                            Set(c_Markup, Value(estMarkPercentage.Text)); Set(c_contingency, Value(estConPercentage.Text))  
                    );
                    If(Trim(DataCardValue1_2.Text) = "",
                     UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
                     If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
                    	   //true code
                    	   If(FirstSaveOnNewEstimate, 
                    	   //true code Updating after the first save
                    		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                    				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
                    				Description: DataCardValue5_2.Text, 
                    				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
                    				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                    				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
                    				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
                    				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                                    //Quote_Cost: Value(QuoteCost.Text),
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, 
                                    LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                                    Navigate(AddShawCostToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
                    	  UpdateContext({NewEstPopUp:true, 
                                        NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
                    					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                         Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
                    		),
                    	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
                    	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
                    	  If(Not(FirstSaveOnNewEstimate), 
                    		 Set(FirstSaveOnNewEstimate, true);
                    		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
                    		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
                    				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
                    				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
                    				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                                    ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                                    Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
                    				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                                    p_percentage: Value("0.0"), 
                                    d_percentage:Value("0.0"),
                    				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
                    				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
                    				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
                    				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
                    				EPC_Sec_TotalCost: Value("0.0"),
                                    Quote_Cost: Value("0.0"), 
                                    epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                                    epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                                    contingency_percentage:e_contingency,
                                    contingency_percentage_xtask:x_contingency,
                                    contingency_percentage_mtask:m_contingency,
                                    contingency_percentage_ctask:c_contingency,
                                    markup_percentage: e_Markup,
                                    markup_percentage_xtask: x_Markup,
                                    markup_percentage_mtask: m_Markup,
                                    markup_percentage_ctask: c_Markup,
                                    siteID:Dropdown21.Selected.Value,
                                    department:Dropdown26.Selected.Value,
                    				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
                    		});
                            Navigate(AddShawCostToEst, ScreenTransition.Fade, {NewEstimateProjectID: DataCardValue1_2.Text, 
                                                    NewEstimateStage: NewEstStage_2.SelectedText.Value,
                                                    NewEstimateVersion: NewEstVersion_2.SelectedText.Value});,
                    		""
                    		);  
                    	);
                    );
                    Refresh(Estimates);
                PressedBorderColor: =Button17_1.Fill
                PressedColor: =Button17_1.Fill
                PressedFill: =Button17_1.Color
                Text: ="Add Shaw Cost"
                Width: =225
                X: =44
                Y: =433
                ZIndex: =27

            Label45_22 As label:
                Color: =RGBA(56, 96, 178, 1)
                FocusedBorderColor: =Label45_22.BorderColor
                Height: =37
                HoverBorderColor: =Label45_22.BorderColor
                HoverColor: =Label45_22.Color
                HoverFill: =Label45_22.Fill
                PressedBorderColor: =Label45_22.BorderColor
                PressedColor: =Label45_22.Color
                PressedFill: =Label45_22.Fill
                Text: |-
                    ="Cost:"
                Width: =85
                X: =323
                Y: =433
                ZIndex: =28

            ShawCost_2 As label:
                FocusedBorderColor: =ShawCost_2.BorderColor
                Height: =23
                HoverBorderColor: =ShawCost_2.BorderColor
                HoverColor: =ShawCost_2.Color
                HoverFill: =ShawCost_2.Fill
                PressedBorderColor: =ShawCost_2.BorderColor
                PressedColor: =ShawCost_2.Color
                PressedFill: =ShawCost_2.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(shaw_cost_total,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(shaw_cost_total,"[$-en-US]$ ###,##0.00"))
                     )
                Width: =213
                X: =480
                Y: =447
                ZIndex: =29

            Label162 As label:
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(Eng_P_Cost,"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Eng_P_Cost,"[$-en-US]$ ###,##0.00"))
                     )
                X: =786
                Y: =302
                ZIndex: =30

        MarkUpControlsSection As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =1111
            Width: =1366
            X: =0
            Y: =2
            ZIndex: =5

            MarkUpHeading_2 As label:
                Color: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =MarkUpHeading_2.BorderColor
                Font: =Font.'Lato Light'
                FontWeight: =FontWeight.Semibold
                Height: =60
                HoverBorderColor: =MarkUpHeading_2.BorderColor
                HoverColor: =MarkUpHeading_2.Color
                HoverFill: =MarkUpHeading_2.Fill
                PressedBorderColor: =MarkUpHeading_2.BorderColor
                PressedColor: =MarkUpHeading_2.Color
                PressedFill: =MarkUpHeading_2.Fill
                Size: =30
                Text: ="MARKUP CONTROLS    &   FINAL ESTIMATE NUMBERS"
                Width: =1347
                ZIndex: =1

            "Gallery5 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver4.0'":
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                DisabledBorderColor: =Gallery5.BorderColor
                DisabledFill: =Gallery5.Fill
                Height: =480
                HoverBorderColor: =Gallery5.BorderColor
                HoverFill: =Gallery5.Fill
                Items: =MarkUp_ContingencyTable
                LoadingSpinnerColor: =Gallery5.BorderColor
                PressedBorderColor: =Gallery5.BorderColor
                PressedFill: =Gallery5.Fill
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =244
                Width: =979
                X: =20
                Y: =534
                ZIndex: =1

                Title15 As label:
                    FocusedBorderColor: =Title15.BorderColor
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    HoverBorderColor: =Title15.BorderColor
                    HoverColor: =Title15.Color
                    HoverFill: =Title15.Fill
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =Title15.BorderColor
                    PressedColor: =Title15.Color
                    PressedFill: =Title15.Fill
                    Size: =16
                    Text: =ThisItem.task_con_markup
                    VerticalAlign: =VerticalAlign.Top
                    Width: =204
                    X: =10
                    Y: =10
                    ZIndex: =2

                Subtitle12 As label:
                    FocusedBorderColor: =Subtitle12.BorderColor
                    Height: =32
                    HoverBorderColor: =Subtitle12.BorderColor
                    HoverColor: =Subtitle12.Color
                    HoverFill: =Subtitle12.Fill
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedBorderColor: =Subtitle12.BorderColor
                    PressedColor: =Subtitle12.Color
                    PressedFill: =Subtitle12.Fill
                    Size: =13
                    Text: ="Sub-Total With Contingency"
                    VerticalAlign: =VerticalAlign.Top
                    Width: =245
                    X: =Title15.X
                    Y: =205
                    ZIndex: =3

                Label89 As label:
                    Color: =RGBA(52, 101, 127, 1)
                    FocusedBorderColor: =Label89.BorderColor
                    Height: =39
                    HoverBorderColor: =Label89.BorderColor
                    HoverColor: =Label89.Color
                    HoverFill: =Label89.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =Label89.BorderColor
                    PressedColor: =Label89.Color
                    PressedFill: =Label89.Fill
                    Text: |-
                        ="Contingency: "
                    Width: =116
                    Y: =119
                    ZIndex: =4

                conValue As label:
                    Color: =RGBA(0, 18, 107, 1)
                    FocusedBorderColor: =conValue.BorderColor
                    FontWeight: =FontWeight.Semibold
                    Height: =42
                    HoverBorderColor: =conValue.BorderColor
                    HoverColor: =conValue.Color
                    HoverFill: =conValue.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =conValue.BorderColor
                    PressedColor: =conValue.Color
                    PressedFill: =conValue.Fill
                    Size: =14
                    Text: |-
                        =/*If(NewEstimate,
                             LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                               And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00")),
                            LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                            Text(Value(totalValue.Text) *  Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00"))
                         )*/
                        
                         Switch(ThisItem.id_con_markup,
                                1, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00"))
                            ),
                                2, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentageXTask.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentageXTask.Text),"[$-en-US]$ ###,##0.00"))
                            ),
                                3, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentageMTask.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentageMTask.Text),"[$-en-US]$ ###,##0.00"))
                            ),
                                4, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentageCTask.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentageCTask.Text),"[$-en-US]$ ###,##0.00"))
                            )
                            )
                        /*If(NewEstimateType = "Fortis Alberta",
                            Switch(ThisItem.id_con_markup,
                                1, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00"))
                            ),
                                2, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentageXTask.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentageXTask.Text),"[$-en-US]$ ###,##0.00"))
                            ),
                                3, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentageMTask.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentageMTask.Text),"[$-en-US]$ ###,##0.00"))
                            ),
                                4, If(NewEstimate,
                                LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                                And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentageCTask.Text),"[$-en-US]$ ###,##0.00")),
                                LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                    And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                                Text(Value(totalValue.Text) *  Value(estConPercentageCTask.Text),"[$-en-US]$ ###,##0.00"))
                            )
                            ),
                            If(NewEstimate,
                             LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                               And Version = NewEstimateVersion And Type = NewEstimateType, Text(Value(totalValue.Text) * Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00")),
                            LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                            Text(Value(totalValue.Text) *  Value(estConPercentage.Text),"[$-en-US]$ ###,##0.00"))
                            )
                        )*/
                    Width: =123
                    X: =38
                    Y: =159
                    ZIndex: =5

                totalValue As label:
                    Color: =RGBA(111, 162, 135, 1)
                    FocusedBorderColor: =totalValue.BorderColor
                    FontWeight: =FontWeight.Bold
                    Height: =39
                    HoverBorderColor: =totalValue.BorderColor
                    HoverColor: =totalValue.Color
                    HoverFill: =totalValue.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =totalValue.BorderColor
                    PressedColor: =totalValue.Color
                    PressedFill: =totalValue.Fill
                    Size: =16
                    Text: |-
                        =Switch(ThisItem.id_con_markup,
                            1, If(NewEstimate,
                             LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                               And Version = NewEstimateVersion And Type = NewEstimateType, Text(Eng_D_Cost + Eng_P_Cost + Quote_Cost,"[$-en-US]$ ###,##0.00")),
                            LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                            Text(Eng_D_Cost + Eng_P_Cost + Quote_Cost,"[$-en-US]$ ###,##0.00"))),
                            2, If(NewEstimate,
                             LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                               And Version = NewEstimateVersion And Type = NewEstimateType, Text(Permit_M_Cost+ Permit_L_Cost + Extra_M_Cost + Extra_L_Cost,"[$-en-US]$ ###,##0.00")),
                            LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                            Text(Permit_M_Cost+ Permit_L_Cost + Extra_M_Cost + Extra_L_Cost,"[$-en-US]$ ###,##0.00"))),
                            3, If(NewEstimate,
                             LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                               And Version = NewEstimateVersion And Type = NewEstimateType, Text(Struc_M_Cost + Material_Cost,"[$-en-US]$ ###,##0.00")),
                            LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                            Text(Struc_M_Cost + Material_Cost,"[$-en-US]$ ###,##0.00"))),
                            4, If(NewEstimate,
                             LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                               And Version = NewEstimateVersion And Type = NewEstimateType, Text(Struc_L_Cost + Labour_Cost,"[$-en-US]$ ###,##0.00")),
                            LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                                And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                            Text(Struc_L_Cost + Labour_Cost,"[$-en-US]$ ###,##0.00")))
                        )
                    X: =37
                    Y: =40
                    ZIndex: =7

                SubTotWithCon As label:
                    Color: =RGBA(111, 162, 135, 1)
                    FocusedBorderColor: =SubTotWithCon.BorderColor
                    FontWeight: =FontWeight.Bold
                    HoverBorderColor: =SubTotWithCon.BorderColor
                    HoverColor: =SubTotWithCon.Color
                    HoverFill: =SubTotWithCon.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =SubTotWithCon.BorderColor
                    PressedColor: =SubTotWithCon.Color
                    PressedFill: =SubTotWithCon.Fill
                    Size: =14
                    Text: |-
                        =Text(Value(totalValue.Text) + Value(conValue.Text),"[$-en-US]$ ###,##0.00")
                    X: =37
                    Y: =231
                    ZIndex: =8

                Label95 As label:
                    Color: =RGBA(52, 101, 127, 1)
                    FocusedBorderColor: =Label95.BorderColor
                    Height: =44
                    HoverBorderColor: =Label95.BorderColor
                    HoverColor: =Label95.Color
                    HoverFill: =Label95.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =Label95.BorderColor
                    PressedColor: =Label95.Color
                    PressedFill: =Label95.Fill
                    Text: |-
                        ="Markup: "
                    Width: =86
                    X: =10
                    Y: =305
                    ZIndex: =9

                markValue As label:
                    Color: =RGBA(0, 18, 107, 1)
                    FocusedBorderColor: =markValue.BorderColor
                    FontWeight: =FontWeight.Semibold
                    HoverBorderColor: =markValue.BorderColor
                    HoverColor: =markValue.Color
                    HoverFill: =markValue.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =markValue.BorderColor
                    PressedColor: =markValue.Color
                    PressedFill: =markValue.Fill
                    Size: =14
                    Text: |-
                        =//Text(Value(SubTotWithCon.Text) * Value(estMarkPercentage.Text),"[$-en-US]$ ###,##0.00") 
                        
                        Switch(ThisItem.id_con_markup,
                                    1, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentage.Text),"[$-en-US]$ ###,##0.00") 
                                ,
                                    2, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentageXTask.Text),"[$-en-US]$ ###,##0.00") 
                                ,
                                    3, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentageMTask.Text),"[$-en-US]$ ###,##0.00") 
                                ,
                                    4, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentageCTask.Text),"[$-en-US]$ ###,##0.00") 
                            )
                        /*If(NewEstimateType = "Fortis Alberta",
                            Switch(ThisItem.id_con_markup,
                                    1, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentage.Text),"[$-en-US]$ ###,##0.00") 
                                ,
                                    2, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentageXTask.Text),"[$-en-US]$ ###,##0.00") 
                                ,
                                    3, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentageMTask.Text),"[$-en-US]$ ###,##0.00") 
                                ,
                                    4, Text(Value(SubTotWithCon.Text) * Value(estMarkPercentageCTask.Text),"[$-en-US]$ ###,##0.00") 
                            ),
                            Text(Value(SubTotWithCon.Text) * Value(estMarkPercentage.Text),"[$-en-US]$ ###,##0.00") 
                        )*/
                            
                    X: =42
                    Y: =350
                    ZIndex: =10

                Label97 As label:
                    FocusedBorderColor: =Label97.BorderColor
                    FontWeight: =FontWeight.Bold
                    HoverBorderColor: =Label97.BorderColor
                    HoverColor: =Label97.Color
                    HoverFill: =Label97.Fill
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =Label97.BorderColor
                    PressedColor: =Label97.Color
                    PressedFill: =Label97.Fill
                    Size: =16
                    Text: |-
                        =If(ThisItem.id_con_markup = 1, "Total Quotation: ", "")
                    Width: =324
                    X: =10
                    Y: =396
                    ZIndex: =11

                TotalQ As text:
                    Color: =RGBA(118, 0, 0, 1)
                    Default: |-
                        =Text(Value(SubTotWithCon.Text) + Value(markValue.Text),"[$-en-US]$ ###,##0.00") 
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =TotalQ.BorderColor
                    FontWeight: =FontWeight.Bold
                    Height: =45
                    HoverFill: =RGBA(255, 255, 255, 1)
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =TotalQ.HoverBorderColor
                    PressedColor: =TotalQ.Color
                    PressedFill: =TotalQ.Fill
                    Size: =16
                    Width: =160
                    X: =32
                    Y: =436
                    ZIndex: =13

                continInput As text:
                    Color: =RGBA(52, 101, 127, 1)
                    Default: |-
                        =//changes for applying different value of contigencies
                        /*If(NewEstimateType = "Fortis Alberta",
                            Switch(ThisItem.id_con_markup,
                                1, Text(Value(estConPercentage.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                2, Text(Value(estConPercentageXTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                3, Text(Value(estConPercentageMTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                4, Text(Value(estConPercentageCTask.Text) * 100, "[$-en-US] ###,##0.00 %")
                            ),
                            Text(Value(estConPercentage.Text) * 100, "[$-en-US] ###,##0.00 %")
                        )*/
                        
                        Switch(ThisItem.id_con_markup,
                                1, Text(Value(estConPercentage.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                2, Text(Value(estConPercentageXTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                3, Text(Value(estConPercentageMTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                4, Text(Value(estConPercentageCTask.Text) * 100, "[$-en-US] ###,##0.00 %")
                            )
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =continInput.BorderColor
                    Format: =TextFormat.Number
                    Height: =39
                    HoverFill: =RGBA(255, 255, 255, 1)
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =continInput.HoverBorderColor
                    PressedColor: =continInput.Color
                    PressedFill: =continInput.Fill
                    Width: =112
                    X: =116
                    Y: =119
                    ZIndex: =14

                markInput As text:
                    Color: =RGBA(52, 101, 127, 1)
                    Default: |-
                        =//changes for applying different value of contigencies
                        /*If(NewEstimateType = "Fortis Alberta",
                            Switch(ThisItem.id_con_markup,
                                1, Text(Value(estMarkPercentage.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                2, Text(Value(estMarkPercentageXTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                3, Text(Value(estMarkPercentageMTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                4, Text(Value(estMarkPercentageCTask.Text) * 100, "[$-en-US] ###,##0.00 %")
                            ),
                            Text(Value(estMarkPercentage.Text) * 100, "[$-en-US] ###,##0.00 %")
                        )*/
                        
                        Switch(ThisItem.id_con_markup,
                                1, Text(Value(estMarkPercentage.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                2, Text(Value(estMarkPercentageXTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                3, Text(Value(estMarkPercentageMTask.Text) * 100, "[$-en-US] ###,##0.00 %"),
                                4, Text(Value(estMarkPercentageCTask.Text) * 100, "[$-en-US] ###,##0.00 %")
                        )
                    DisplayMode: =DisplayMode.View
                    FocusedBorderColor: =markInput.BorderColor
                    Format: =TextFormat.Number
                    Height: =30
                    HoverFill: =RGBA(255, 255, 255, 1)
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =markInput.HoverBorderColor
                    PressedColor: =markInput.Color
                    PressedFill: =markInput.Fill
                    Width: =99
                    X: =96
                    Y: =312
                    ZIndex: =15

                Icon56 As icon.VerticalLine:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    BorderStyle: =BorderStyle.Dashed
                    BorderThickness: =2
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledFill: =Icon56.Fill
                    Height: =460
                    HoverBorderColor: =ColorFade(Icon56.BorderColor, 20%)
                    HoverColor: =ColorFade(Icon56.Color, 20%)
                    HoverFill: =Icon56.Fill
                    Icon: =Icon.VerticalLine
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =ColorFade(Icon56.BorderColor, -20%)
                    PressedColor: =ColorFade(Icon56.Color, -20%)
                    PressedFill: =Icon56.Fill
                    Width: =0
                    X: =243
                    Y: =10
                    ZIndex: =16

                Icon52 As icon.HorizontalLine:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    BorderStyle: =BorderStyle.Dashed
                    BorderThickness: =2
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledFill: =Icon52.Fill
                    Height: =0
                    HoverBorderColor: =ColorFade(Icon52.BorderColor, 20%)
                    HoverColor: =ColorFade(Icon52.Color, 20%)
                    HoverFill: =Icon52.Fill
                    Icon: =Icon.HorizontalLine
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =ColorFade(Icon52.BorderColor, -20%)
                    PressedColor: =ColorFade(Icon52.Color, -20%)
                    PressedFill: =Icon52.Fill
                    Width: =242
                    X: =1
                    Y: =119
                    ZIndex: =17

                Icon52_1 As icon.HorizontalLine:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    BorderStyle: =BorderStyle.Dashed
                    BorderThickness: =2
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledFill: =Icon52_1.Fill
                    Height: =0
                    HoverBorderColor: =ColorFade(Icon52_1.BorderColor, 20%)
                    HoverColor: =ColorFade(Icon52_1.Color, 20%)
                    HoverFill: =Icon52_1.Fill
                    Icon: =Icon.HorizontalLine
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =ColorFade(Icon52_1.BorderColor, -20%)
                    PressedColor: =ColorFade(Icon52_1.Color, -20%)
                    PressedFill: =Icon52_1.Fill
                    Width: =242
                    Y: =310
                    ZIndex: =18

                Icon52_2 As icon.HorizontalLine:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    BorderStyle: =BorderStyle.Dashed
                    BorderThickness: =2
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledFill: =Icon52_2.Fill
                    Height: =0
                    HoverBorderColor: =ColorFade(Icon52_2.BorderColor, 20%)
                    HoverColor: =ColorFade(Icon52_2.Color, 20%)
                    HoverFill: =Icon52_2.Fill
                    Icon: =Icon.HorizontalLine
                    OnSelect: =Select(Parent)
                    PressedBorderColor: =ColorFade(Icon52_2.BorderColor, -20%)
                    PressedColor: =ColorFade(Icon52_2.Color, -20%)
                    PressedFill: =Icon52_2.Fill
                    Width: =242
                    Y: =396
                    ZIndex: =19

                Label158 As label:
                    Color: =RGBA(111, 162, 135, 1)
                    FontWeight: =FontWeight.Bold
                    Height: =38
                    OnSelect: =Select(Parent)
                    Size: =16
                    Text: |-
                        ="GM: " & Text((TotalQ - totalValue)/TotalQ * 100,"[$-en-US]#.00 %")
                    Width: =172
                    X: =35
                    Y: =78
                    ZIndex: =20

                Label159 As label:
                    Color: =RGBA(111, 162, 135, 1)
                    FontWeight: =FontWeight.Bold
                    OnSelect: =Select(Parent)
                    Size: =14
                    Text: |-
                        ="GM: " & Text((TotalQ - SubTotWithCon)/TotalQ * 100,"[$-en-US]#.00 %")
                    X: =37
                    Y: =267
                    ZIndex: =21

            EPCCostLabel As label:
                FocusedBorderColor: =EPCCostLabel.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =45
                HoverBorderColor: =EPCCostLabel.BorderColor
                HoverColor: =EPCCostLabel.Color
                HoverFill: =EPCCostLabel.Fill
                PressedBorderColor: =EPCCostLabel.BorderColor
                PressedColor: =EPCCostLabel.Color
                PressedFill: =EPCCostLabel.Fill
                Text: =LookUp(EPC_table, epc_ID = 14, Concatenate(EPC_items, " %"))
                Width: =130
                X: =41
                Y: =212
                ZIndex: =7

            EPCCHEVYLabel As label:
                FocusedBorderColor: =EPCCHEVYLabel.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =EPCCHEVYLabel.BorderColor
                HoverColor: =EPCCHEVYLabel.Color
                HoverFill: =EPCCHEVYLabel.Fill
                PressedBorderColor: =EPCCHEVYLabel.BorderColor
                PressedColor: =EPCCHEVYLabel.Color
                PressedFill: =EPCCHEVYLabel.Fill
                Text: =LookUp(EPC_table, epc_ID = 15, Concatenate(EPC_items, " %"))
                X: =712
                Y: =208
                ZIndex: =8

            EPC_COST_percentage As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(EPC_table, epc_ID = 14, epc_percentage),
                    If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(epc_cost_per,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(epc_cost_per ,"[$-en-US] ###,##0.00"))
                     )
                    ) 
                FocusedBorderColor: =EPC_COST_percentage.BorderColor
                Format: =TextFormat.Number
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                PressedBorderColor: =EPC_COST_percentage.HoverBorderColor
                PressedColor: =EPC_COST_percentage.Color
                PressedFill: =EPC_COST_percentage.Fill
                Width: =183
                X: =184
                Y: =209
                ZIndex: =9

            EPC_CHEVY_percentage As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |-
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(EPC_table, epc_ID = 15, epc_percentage),
                    If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(epc_chevy_per,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(epc_chevy_per,"[$-en-US] ###,##0.00"))
                     )
                    )
                FocusedBorderColor: =EPC_CHEVY_percentage.BorderColor
                Format: =TextFormat.Number
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                PressedBorderColor: =EPC_CHEVY_percentage.HoverBorderColor
                PressedColor: =EPC_CHEVY_percentage.Color
                PressedFill: =EPC_CHEVY_percentage.Fill
                Width: =183
                X: =855
                Y: =208
                ZIndex: =10

            Label33 As label:
                Color: =RGBA(168, 0, 0, 1)
                FocusedBorderColor: =Label33.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =50
                HoverBorderColor: =Label33.BorderColor
                HoverColor: =Label33.Color
                HoverFill: =Label33.Fill
                PressedBorderColor: =Label33.BorderColor
                PressedColor: =Label33.Color
                PressedFill: =Label33.Fill
                Text: ="Please enter percentages as a decimal value only eg. 5% will be written as 0.05"
                Width: =612
                X: =41
                Y: =134
                ZIndex: =11

            Label80 As label:
                FocusedBorderColor: =Label80.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label80.BorderColor
                HoverColor: =Label80.Color
                HoverFill: =Label80.Fill
                PressedBorderColor: =Label80.BorderColor
                PressedColor: =Label80.Color
                PressedFill: =Label80.Fill
                Text: |-
                    ="Sum of all costs :"
                Width: =166
                X: =36
                Y: =76
                ZIndex: =12

            SumAllCostBeforeEPC_Label As label:
                Color: =RGBA(54, 176, 75, 1)
                FocusedBorderColor: =SumAllCostBeforeEPC_Label.BorderColor
                HoverBorderColor: =SumAllCostBeforeEPC_Label.BorderColor
                HoverColor: =SumAllCostBeforeEPC_Label.Color
                HoverFill: =SumAllCostBeforeEPC_Label.Fill
                PressedBorderColor: =SumAllCostBeforeEPC_Label.BorderColor
                PressedColor: =SumAllCostBeforeEPC_Label.Color
                PressedFill: =SumAllCostBeforeEPC_Label.Fill
                Text: |-
                    =If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, 
                           Text(Sum(Eng_P_Cost, Eng_D_Cost, Struc_M_Cost, Struc_L_Cost, Material_Cost, Labour_Cost, Permit_M_Cost, Permit_L_Cost,
                                       Extra_M_Cost, Extra_L_Cost, Quote_Cost),"[$-en-US]$ ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(Sum(Eng_P_Cost, Eng_D_Cost, Struc_M_Cost, Struc_L_Cost, Material_Cost, Labour_Cost, Permit_M_Cost, Permit_L_Cost,
                                       Extra_M_Cost, Extra_L_Cost, Quote_Cost),"[$-en-US]$ ###,##0.00"))
                     )
                Width: =320
                X: =215
                Y: =76
                ZIndex: =13

            Label87 As label:
                FocusedBorderColor: =Label87.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =45
                HoverBorderColor: =Label87.BorderColor
                HoverColor: =Label87.Color
                HoverFill: =Label87.Fill
                PressedBorderColor: =Label87.BorderColor
                PressedColor: =Label87.Color
                PressedFill: =Label87.Fill
                Text: ="="
                Width: =40
                X: =392
                Y: =206
                ZIndex: =14

            Label87_1 As label:
                FocusedBorderColor: =Label87_1.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =45
                HoverBorderColor: =Label87_1.BorderColor
                HoverColor: =Label87_1.Color
                HoverFill: =Label87_1.Fill
                PressedBorderColor: =Label87_1.BorderColor
                PressedColor: =Label87_1.Color
                PressedFill: =Label87_1.Fill
                Text: ="="
                Width: =40
                X: =1063
                Y: =204
                ZIndex: =15

            EPCCost_CalculatdValue_Label As label:
                FocusedBorderColor: =EPCCost_CalculatdValue_Label.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =45
                HoverBorderColor: =EPCCost_CalculatdValue_Label.BorderColor
                HoverColor: =EPCCost_CalculatdValue_Label.Color
                HoverFill: =EPCCost_CalculatdValue_Label.Fill
                PressedBorderColor: =EPCCost_CalculatdValue_Label.BorderColor
                PressedColor: =EPCCost_CalculatdValue_Label.Color
                PressedFill: =EPCCost_CalculatdValue_Label.Fill
                Text: |-
                    =Text(Value(EPC_COST_percentage.Text) * Value(SumAllCostBeforeEPC_Label.Text),"[$-en-US]$ ###,##0.00")
                Width: =187
                X: =439
                Y: =206
                ZIndex: =16

            EPCCHEVY_CalculatedValue_Label As label:
                FocusedBorderColor: =EPCCHEVY_CalculatedValue_Label.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =43
                HoverBorderColor: =EPCCHEVY_CalculatedValue_Label.BorderColor
                HoverColor: =EPCCHEVY_CalculatedValue_Label.Color
                HoverFill: =EPCCHEVY_CalculatedValue_Label.Fill
                PressedBorderColor: =EPCCHEVY_CalculatedValue_Label.BorderColor
                PressedColor: =EPCCHEVY_CalculatedValue_Label.Color
                PressedFill: =EPCCHEVY_CalculatedValue_Label.Fill
                Text: |-
                    =Text(Value(EPC_CHEVY_percentage.Text) * Value(SumAllCostBeforeEPC_Label.Text),"[$-en-US]$ ###,##0.00")
                Width: =187
                X: =1110
                Y: =205
                ZIndex: =17

            totalRev As label:
                Color: =RGBA(118, 0, 0, 1)
                FocusedBorderColor: =totalRev.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =42
                HoverBorderColor: =totalRev.BorderColor
                HoverColor: =totalRev.Color
                HoverFill: =totalRev.Fill
                PressedBorderColor: =totalRev.BorderColor
                PressedColor: =totalRev.Color
                PressedFill: =totalRev.Fill
                Size: =16
                Text: |-
                    =Text(Sum(Gallery5.AllItems, TotalQ),"[$-en-US]$ ###,##0.00")
                    
                    /*If(NewEstimateType = "Fortis Alberta",
                        Text(Value((estMarkPercentage+estMarkPercentageMTask+estMarkPercentageXTask+estMarkPercentageCTask)/4)* (Sum(Gallery5.AllItems,totalValue) + Sum(Gallery5.AllItems,      totalValue) * (estConPercentage + estConPercentageMTask + estConPercentageXTask + estConPercentageCTask)/4) + Sum(Gallery5.AllItems,totalValue) + Sum(Gallery5.AllItems,totalValue) * (estConPercentage + estConPercentageMTask + estConPercentageXTask + estConPercentageCTask)/4,"[$-en-US]$ ###,##0.00"),
                        Text(Sum(Gallery5.AllItems, TotalQ),"[$-en-US]$ ###,##0.00")
                    )*/
                Width: =205
                X: =1054
                Y: =973
                ZIndex: =18

            Button13 As button:
                BorderColor: =ColorFade(Button13.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =Button13.BorderColor
                Height: =62
                HoverBorderColor: =ColorFade(Button13.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |
                    =Patch(
                        Estimates,
                        LookUp(
                            Estimates,
                            ProjectID = DataCardValue1_2.Text And Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text
                        ),
                        {
                            epc_cost_per: Value(EPC_COST_percentage.Text),
                            epc_chevy_per: Value(EPC_CHEVY_percentage.Text),
                            contingency_percentage: Value(estConPercentage.Text),
                            markup_percentage: Value(estMarkPercentage.Text)
                        }
                    );
                    Launch(
                        Concatenate(
                            "https://pecintranetsrv.primaryeng.com/EstimateWorkBook_V2.php?",
                            "projectID=",
                            DataCardValue1_2.Text,
                            "&stage=",
                            NewEstStage_2.Selected.Value,
                            "&version=",
                            NewEstVersion_2.Selected.Value,
                            "&estimateType=",
                            DataCardValue2_2.Text
                        )
                    );
                PressedBorderColor: =Button13.Fill
                PressedColor: =Button13.Fill
                PressedFill: =Button13.Color
                Text: |-
                    ="Save &
                    Download Estimate"
                Width: =218
                X: =1118
                Y: =1088
                ZIndex: =19

            estMarkPercentage As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 1, markup),
                    If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(markup_percentage,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(markup_percentage ,"[$-en-US] ###,##0.00"))
                     )
                    ) 
                FocusedBorderColor: =estMarkPercentage.BorderColor
                Format: =TextFormat.Number
                Height: =42
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage: Value(estConPercentage.Text),
                                    markup_percentage: Value(estMarkPercentage.Text)
                    })
                PressedBorderColor: =estMarkPercentage.HoverBorderColor
                PressedColor: =estMarkPercentage.Color
                PressedFill: =estMarkPercentage.Fill
                Width: =103
                X: =181
                Y: =342
                ZIndex: =20

            estConPercentage As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                    //need add conID--note from Yichen
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 1, contingeny),
                      If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, 
                           
                           Text(contingency_percentage, "[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(
                            contingency_percentage, "[$-en-US] ###,##0.00"))
                     )
                    )
                FocusedBorderColor: =estConPercentage.BorderColor
                Format: =TextFormat.Number
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage: Value(estConPercentage.Text),
                                    markup_percentage: Value(estMarkPercentage.Text)
                    })
                PressedBorderColor: =estConPercentage.HoverBorderColor
                PressedColor: =estConPercentage.Color
                PressedFill: =estConPercentage.Fill
                Width: =103
                X: =181
                Y: =296
                ZIndex: =21

            Label64 As label:
                FocusedBorderColor: =Label64.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label64.BorderColor
                HoverColor: =Label64.Color
                HoverFill: =Label64.Fill
                PressedBorderColor: =Label64.BorderColor
                PressedColor: =Label64.Color
                PressedFill: =Label64.Fill
                Text: ="Engineering MarkpUp %"
                X: =27
                Y: =344
                ZIndex: =22

            Label70 As label:
                FocusedBorderColor: =Label70.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label70.BorderColor
                HoverColor: =Label70.Color
                HoverFill: =Label70.Fill
                PressedBorderColor: =Label70.BorderColor
                PressedColor: =Label70.Color
                PressedFill: =Label70.Fill
                Text: ="Engineering Contingency %"
                X: =27
                Y: =296
                ZIndex: =23

            Button14 As button:
                BorderColor: =ColorFade(Button14.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                Height: =54
                HoverBorderColor: =ColorFade(Button14.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |-
                    =Set(flowProjectID,DataCardValue1_2.Text);
                    Set(flowStage,NewEstStage_2.SelectedText.Value);
                    Set(flowVersion,NewEstVersion_2.SelectedText.Value);
                    Set(flowType,DataCardValue2_2.Text);
                    Set(flowVendor,NewEstMatSupplier_2.SelectedText.Value);
                    Clear(myData);
                    Clear(myData2);
                    Clear(myData3);
                    If(flowVendor="Preferred Vendor",
                        Switch(CurrentEstimateType,
                            "Enmax", ClearCollect(myData, FixMinQtyPref_Enmax.Run(flowProjectID,flowStage,flowVersion,flowType,flowVendor)),
                            "Fortis Alberta", ClearCollect(myData2, FixMinQtyPref_FortisAlberta.Run(flowProjectID,flowStage,flowVersion,flowType,flowVendor)),
                            "City of Calgary", ClearCollect(myData3, FixMinQtyPref_CoC.Run(flowProjectID,flowStage,flowVersion,flowType,flowVendor))
                        ), 
                        false
                    );
                    
                    
                    Navigate(ViewAndFixMatMinQtyScreen,ScreenTransition.Fade);
                PressedBorderColor: =Button14.Fill
                PressedColor: =Button14.Fill
                PressedFill: =Button14.Color
                Text: ="View Materials' With Min Qty Issues"
                Width: =398
                X: =20
                Y: =432
                ZIndex: =24

            Label123 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Semibold
                Height: =34
                Size: =14
                Text: |-
                    =Text(Sum(Gallery5.AllItems,conValue),"[$-en-US]$ ###,##0.00")
                    /*If(NewEstimateType = "Fortis Alberta",
                        Text(Sum(Gallery5.AllItems,totalValue) * (estConPercentage + estConPercentageMTask + estConPercentageXTask + estConPercentageCTask)/4,"[$-en-US]$ ###,##0.00"),
                        Text(Sum(Gallery5.AllItems,conValue),"[$-en-US]$ ###,##0.00")
                    )*/
                Width: =130
                X: =1061
                Y: =698
                ZIndex: =27

            Label124 As label:
                FontWeight: =FontWeight.Bold
                Height: =42
                Size: =16
                Text: ="Totals"
                Width: =154
                X: =1049
                Y: =536
                ZIndex: =28

            Label125 As label:
                Color: =RGBA(111, 162, 135, 1)
                FontWeight: =FontWeight.Bold
                Size: =16
                Text: |-
                    =Text(Sum(Gallery5.AllItems,totalValue),"[$-en-US]$ ###,##0.00")
                X: =1053
                Y: =573
                ZIndex: =29

            Label126 As label:
                Color: =RGBA(56, 96, 178, 1)
                Height: =32
                Text: |-
                    =If(NewEstimateType = "Fortis Alberta",
                        Text(Value((estConPercentage + estConPercentageMTask + estConPercentageXTask + estConPercentageCTask)/4) * 100, "[$-en-US] ###,##0.00 %"),
                        Text(Value(estConPercentage.Text) * 100, "[$-en-US] ###,##0.00 %")
                    )
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", false, true)
                    false
                Width: =95
                X: =1143
                Y: =659
                ZIndex: =30

            Label127 As label:
                Color: =RGBA(56, 96, 178, 1)
                Height: =34
                Text: |-
                    ="Contingency:"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", false, true)
                    false
                Width: =122
                X: =1016
                Y: =855
                ZIndex: =31

            Label128 As label:
                Height: =32
                Text: ="Sub-Total With Contingency"
                Width: =272
                X: =1021
                Y: =732
                ZIndex: =32

            Label130 As label:
                Color: =RGBA(111, 162, 135, 1)
                FontWeight: =FontWeight.Bold
                Size: =14
                Text: |-
                    =Text(Sum(Gallery5.AllItems,SubTotWithCon),"[$-en-US]$ ###,##0.00")
                    /*If(NewEstimateType = "Fortis Alberta",
                        Text(Sum(Gallery5.AllItems,totalValue) + Sum(Gallery5.AllItems,totalValue) * (estConPercentage + estConPercentageMTask + estConPercentageXTask + estConPercentageCTask)/4,"[$-en-US]$ ###,##0.00"),
                        Text(Sum(Gallery5.AllItems,SubTotWithCon),"[$-en-US]$ ###,##0.00")
                    )*/
                X: =1061
                Y: =764
                ZIndex: =34

            Label126_1 As label:
                Color: =RGBA(56, 96, 178, 1)
                Height: =32
                Text: |-
                    =If(NewEstimateType = "Fortis Alberta",
                        Text(Value((estMarkPercentage+estMarkPercentageMTask+estMarkPercentageXTask+estMarkPercentageCTask)/4) * 100, "[$-en-US] ###,##0.00 %"),
                        Text(Value(estMarkPercentage.Text) * 100, "[$-en-US] ###,##0.00 %")
                    )
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", false, true)
                    false
                Width: =95
                X: =1156
                Y: =850
                ZIndex: =35

            Label127_1 As label:
                Color: =RGBA(56, 96, 178, 1)
                Height: =34
                Text: |-
                    ="Markup:"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", false, true)
                    false
                Width: =122
                X: =1021
                Y: =668
                ZIndex: =36

            Label131 As label:
                Color: =RGBA(0, 18, 107, 1)
                FontWeight: =FontWeight.Semibold
                Size: =14
                Text: |-
                    =Text(Sum(Gallery5.AllItems,markValue),"[$-en-US]$ ###,##0.00")
                    
                    /*If(NewEstimateType = "Fortis Alberta",
                        Text(Value((estMarkPercentage+estMarkPercentageMTask+estMarkPercentageXTask+estMarkPercentageCTask)/4)* (Sum(Gallery5.AllItems,totalValue) + Sum(Gallery5.AllItems,totalValue) * (estConPercentage + estConPercentageMTask + estConPercentageXTask + estConPercentageCTask)/4),"[$-en-US]$ ###,##0.00"),
                        Text(Sum(Gallery5.AllItems,markValue),"[$-en-US]$ ###,##0.00")
                    )*/
                        
                X: =1062
                Y: =882
                ZIndex: =37

            Label133 As label:
                Color: =RGBA(118, 0, 0, 1)
                FontWeight: =FontWeight.Semibold
                Text: |
                    =Text(Round(Sum(Label99.Text, Label99_1.Text, Label99_2.Text, Label99_3.Text) * 100, 0),"[$-en-US] ###,##0.00 %")
                X: =1117
                Y: =1013
                ZIndex: =38

            Label99 As label:
                Color: =RGBA(118, 0, 0, 1)
                Text: |-
                    =If(Value(totalRev.Text) > 0,
                       Text(LookUp(Gallery5.AllItems,id_con_markup = 1, Value(TotalQ.Text))/ Value(totalRev.Text) * 100, "[$-en-US]#.00 %"),
                       "0.00 %") 
                Width: =95
                X: =107
                Y: =1013
                ZIndex: =39

            Label99_1 As label:
                Color: =RGBA(118, 0, 0, 1)
                Text: |-
                    =If(Value(totalRev.Text) > 0,
                       Text(LookUp(Gallery5.AllItems,id_con_markup = 2, Value(TotalQ.Text))/ Value(totalRev.Text) * 100, "[$-en-US]#.00 %"),
                       "0.00 %") 
                Width: =95
                X: =339
                Y: =1013
                ZIndex: =40

            Label99_2 As label:
                Color: =RGBA(118, 0, 0, 1)
                Text: |-
                    =If(Value(totalRev.Text) > 0,
                       Text(LookUp(Gallery5.AllItems,id_con_markup = 3, Value(TotalQ.Text))/ Value(totalRev.Text) * 100, "[$-en-US]#.00 %"),
                       "0.00 %") 
                Width: =95
                X: =596
                Y: =1013
                ZIndex: =41

            Label99_3 As label:
                Color: =RGBA(118, 0, 0, 1)
                Text: |-
                    =If(Value(totalRev.Text) > 0,
                       Text(LookUp(Gallery5.AllItems,id_con_markup = 4, Value(TotalQ.Text))/ Value(totalRev.Text) * 100, "[$-en-US]#.00 %"),
                       "0.00 %") 
                Width: =95
                X: =852
                Y: =1013
                ZIndex: =42

            estPDF As icon.DocumentPDF:
                Color: =RGBA(56, 96, 178, 1)
                DisabledFill: =estPDF.Fill
                HoverBorderColor: =ColorFade(estPDF.BorderColor, 20%)
                HoverColor: =ColorFade(estPDF.Color, 20%)
                HoverFill: =estPDF.Fill
                Icon: =Icon.DocumentPDF
                PressedBorderColor: =ColorFade(estPDF.BorderColor, -20%)
                PressedColor: =ColorFade(estPDF.Color, -20%)
                PressedFill: =estPDF.Fill
                Tooltip: ="Download Estimate"
                Visible: =false
                X: =1079
                Y: =987
                ZIndex: =43

            Icon52_3 As icon.HorizontalLine:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                Color: =RGBA(0, 0, 0, 1)
                DisabledFill: =Icon52_3.Fill
                Height: =2
                HoverBorderColor: =ColorFade(Icon52_3.BorderColor, 20%)
                HoverColor: =ColorFade(Icon52_3.Color, 20%)
                HoverFill: =Icon52_3.Fill
                Icon: =Icon.HorizontalLine
                PressedBorderColor: =ColorFade(Icon52_3.BorderColor, -20%)
                PressedColor: =ColorFade(Icon52_3.Color, -20%)
                PressedFill: =Icon52_3.Fill
                Width: =265
                X: =1002
                Y: =654
                ZIndex: =44

            Icon52_4 As icon.HorizontalLine:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                Color: =RGBA(0, 0, 0, 1)
                DisabledFill: =Icon52_4.Fill
                Height: =2
                HoverBorderColor: =ColorFade(Icon52_4.BorderColor, 20%)
                HoverColor: =ColorFade(Icon52_4.Color, 20%)
                HoverFill: =Icon52_4.Fill
                Icon: =Icon.HorizontalLine
                PressedBorderColor: =ColorFade(Icon52_4.BorderColor, -20%)
                PressedColor: =ColorFade(Icon52_4.Color, -20%)
                PressedFill: =Icon52_4.Fill
                Width: =270
                X: =1002
                Y: =844
                ZIndex: =45

            Icon52_5 As icon.HorizontalLine:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                Color: =RGBA(0, 0, 0, 1)
                DisabledFill: =Icon52_5.Fill
                Height: =0
                HoverBorderColor: =ColorFade(Icon52_5.BorderColor, 20%)
                HoverColor: =ColorFade(Icon52_5.Color, 20%)
                HoverFill: =Icon52_5.Fill
                Icon: =Icon.HorizontalLine
                PressedBorderColor: =ColorFade(Icon52_5.BorderColor, -20%)
                PressedColor: =ColorFade(Icon52_5.Color, -20%)
                PressedFill: =Icon52_5.Fill
                Width: =270
                X: =1001
                Y: =931
                ZIndex: =46

            Icon52_6 As icon.HorizontalLine:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                Color: =RGBA(0, 0, 0, 1)
                DisabledFill: =Icon52_6.Fill
                Height: =0
                HoverBorderColor: =ColorFade(Icon52_6.BorderColor, 20%)
                HoverColor: =ColorFade(Icon52_6.Color, 20%)
                HoverFill: =Icon52_6.Fill
                Icon: =Icon.HorizontalLine
                PressedBorderColor: =ColorFade(Icon52_6.BorderColor, -20%)
                PressedColor: =ColorFade(Icon52_6.Color, -20%)
                PressedFill: =Icon52_6.Fill
                Width: =270
                X: =998
                Y: =1013
                ZIndex: =47

            Icon52_7 As icon.HorizontalLine:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                Color: =RGBA(0, 0, 0, 1)
                DisabledFill: =Icon52_7.Fill
                Height: =0
                HoverBorderColor: =ColorFade(Icon52_7.BorderColor, 20%)
                HoverColor: =ColorFade(Icon52_7.Color, 20%)
                HoverFill: =Icon52_7.Fill
                Icon: =Icon.HorizontalLine
                PressedBorderColor: =ColorFade(Icon52_7.BorderColor, -20%)
                PressedColor: =ColorFade(Icon52_7.Color, -20%)
                PressedFill: =Icon52_7.Fill
                Width: =270
                X: =1005
                Y: =534
                ZIndex: =48

            Icon57 As icon.VerticalLine:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =2
                Color: =RGBA(255, 255, 255, 1)
                DisabledFill: =Icon57.Fill
                Height: =482
                HoverBorderColor: =ColorFade(Icon57.BorderColor, 20%)
                HoverColor: =ColorFade(Icon57.Color, 20%)
                HoverFill: =Icon57.Fill
                Icon: =Icon.VerticalLine
                PressedBorderColor: =ColorFade(Icon57.BorderColor, -20%)
                PressedColor: =ColorFade(Icon57.Color, -20%)
                PressedFill: =Icon57.Fill
                Width: =0
                X: =1272
                Y: =531
                ZIndex: =49

            estMarkPercentageXTask As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 2, markup),
                    If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(markup_percentage_xtask,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(markup_percentage_xtask, "[$-en-US] ###,##0.00"))
                     )
                    ) 
                FocusedBorderColor: =estMarkPercentageXTask.BorderColor
                Format: =TextFormat.Number
                Height: =42
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage_xtask: Value(estConPercentageXTask.Text),
                                    markup_percentage_xtask: Value(estMarkPercentageXTask.Text)
                    })
                PressedBorderColor: =estMarkPercentageXTask.HoverBorderColor
                PressedColor: =estMarkPercentageXTask.Color
                PressedFill: =estMarkPercentageXTask.Fill
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =103
                X: =507
                Y: =342
                ZIndex: =50

            estConPercentageXTask As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 2, contingeny),
                      If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(contingency_percentage_xtask,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(contingency_percentage_xtask ,"[$-en-US] ###,##0.00"))
                     )
                    )
                FocusedBorderColor: =estConPercentageXTask.BorderColor
                Format: =TextFormat.Number
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage_xtask: Value(estConPercentageXTask.Text),
                                    markup_percentage_xtask: Value(estMarkPercentageXTask.Text) 
                    })
                PressedBorderColor: =estConPercentageXTask.HoverBorderColor
                PressedColor: =estConPercentageXTask.Color
                PressedFill: =estConPercentageXTask.Fill
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =103
                X: =507
                Y: =296
                ZIndex: =51

            Label64_1 As label:
                FocusedBorderColor: =Label64_1.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label64_1.BorderColor
                HoverColor: =Label64_1.Color
                HoverFill: =Label64_1.Fill
                PressedBorderColor: =Label64_1.BorderColor
                PressedColor: =Label64_1.Color
                PressedFill: =Label64_1.Fill
                Text: ="X Task MarkpUp %"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                X: =353
                Y: =344
                ZIndex: =52

            Label70_1 As label:
                FocusedBorderColor: =Label70_1.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label70_1.BorderColor
                HoverColor: =Label70_1.Color
                HoverFill: =Label70_1.Fill
                PressedBorderColor: =Label70_1.BorderColor
                PressedColor: =Label70_1.Color
                PressedFill: =Label70_1.Fill
                Text: ="X Task Contingency %"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                X: =353
                Y: =296
                ZIndex: =53

            estMarkPercentageMTask As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 3, markup),
                    If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(markup_percentage_mtask,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(markup_percentage_mtask ,"[$-en-US] ###,##0.00"))
                     )
                    ) 
                FocusedBorderColor: =estMarkPercentageMTask.BorderColor
                Format: =TextFormat.Number
                Height: =42
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage_mtask: Value(estConPercentageMTask.Text),
                                    markup_percentage_mtask: Value(estMarkPercentageMTask.Text)
                    })
                PressedBorderColor: =estMarkPercentageMTask.HoverBorderColor
                PressedColor: =estMarkPercentageMTask.Color
                PressedFill: =estMarkPercentageMTask.Fill
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =103
                X: =840
                Y: =342
                ZIndex: =54

            estConPercentageMTask As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 3, contingeny),
                      If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(contingency_percentage_mtask,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(contingency_percentage_mtask ,"[$-en-US] ###,##0.00"))
                     )
                    )
                FocusedBorderColor: =estConPercentageMTask.BorderColor
                Format: =TextFormat.Number
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage_mtask: Value(estConPercentageMTask.Text),
                                    markup_percentage_mtask: Value(estMarkPercentageMTask.Text)
                    })
                PressedBorderColor: =estConPercentageMTask.HoverBorderColor
                PressedColor: =estConPercentageMTask.Color
                PressedFill: =estConPercentageMTask.Fill
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =103
                X: =840
                Y: =296
                ZIndex: =55

            Label64_2 As label:
                FocusedBorderColor: =Label64_2.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label64_2.BorderColor
                HoverColor: =Label64_2.Color
                HoverFill: =Label64_2.Fill
                PressedBorderColor: =Label64_2.BorderColor
                PressedColor: =Label64_2.Color
                PressedFill: =Label64_2.Fill
                Text: ="M Task Material MarkpUp %"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =154
                X: =679
                Y: =344
                ZIndex: =56

            Label70_2 As label:
                FocusedBorderColor: =Label70_2.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label70_2.BorderColor
                HoverColor: =Label70_2.Color
                HoverFill: =Label70_2.Fill
                PressedBorderColor: =Label70_2.BorderColor
                PressedColor: =Label70_2.Color
                PressedFill: =Label70_2.Fill
                Text: ="M Task Material Contingency %"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =154
                X: =679
                Y: =296
                ZIndex: =57

            estMarkPercentageCTask As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 4, markup),
                    If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(markup_percentage_ctask,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(markup_percentage_ctask ,"[$-en-US] ###,##0.00"))
                     )
                    ) 
                FocusedBorderColor: =estMarkPercentageCTask.BorderColor
                Format: =TextFormat.Number
                Height: =42
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage_ctask: Value(estConPercentageCTask.Text),
                                    markup_percentage_ctask: Value(estMarkPercentageCTask.Text)
                    })
                PressedBorderColor: =estMarkPercentageCTask.HoverBorderColor
                PressedColor: =estMarkPercentageCTask.Color
                PressedFill: =estMarkPercentageCTask.Fill
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =103
                X: =1162
                Y: =342
                ZIndex: =58

            estConPercentageCTask As text:
                BorderColor: =RGBA(36, 76, 90, 1)
                Default: |
                    =If(Not(FirstSaveOnNewEstimate),
                      LookUp(MarkUp_ContingencyTable, id_con_markup = 4, contingeny),
                      If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, Text(contingency_percentage_ctask,"[$-en-US] ###,##0.00")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        Text(contingency_percentage_ctask ,"[$-en-US] ###,##0.00"))
                     )
                    )
                FocusedBorderColor: =estConPercentageCTask.BorderColor
                Format: =TextFormat.Number
                HoverBorderColor: =RGBA(36, 76, 90, 0.7)
                OnChange: |-
                    =Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
                    				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
                    				{
                                    epc_cost_per: Value(EPC_COST_percentage.Text),
                                    epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                                    contingency_percentage_ctask: Value(estConPercentageCTask.Text),
                                    markup_percentage_ctask: Value(estMarkPercentageCTask.Text)
                    })
                PressedBorderColor: =estConPercentageCTask.HoverBorderColor
                PressedColor: =estConPercentageCTask.Color
                PressedFill: =estConPercentageCTask.Fill
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                Width: =103
                X: =1162
                Y: =296
                ZIndex: =59

            Label64_3 As label:
                FocusedBorderColor: =Label64_3.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label64_3.BorderColor
                HoverColor: =Label64_3.Color
                HoverFill: =Label64_3.Fill
                PressedBorderColor: =Label64_3.BorderColor
                PressedColor: =Label64_3.Color
                PressedFill: =Label64_3.Fill
                Text: ="C Task Labour MarkpUp %"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                X: =1008
                Y: =344
                ZIndex: =60

            Label70_3 As label:
                FocusedBorderColor: =Label70_3.BorderColor
                FontWeight: =FontWeight.Bold
                HoverBorderColor: =Label70_3.BorderColor
                HoverColor: =Label70_3.Color
                HoverFill: =Label70_3.Fill
                PressedBorderColor: =Label70_3.BorderColor
                PressedColor: =Label70_3.Color
                PressedFill: =Label70_3.Fill
                Text: ="C Task Labour Contingency %"
                Visible: |-
                    =//If(NewEstimateType = "Fortis Alberta", true, false)
                    true
                X: =1008
                Y: =296
                ZIndex: =61

            "'TotalGM/WO' As label":
                Color: =RGBA(111, 162, 135, 1)
                FocusedBorderColor: ='TotalGM/WO'.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =38
                HoverBorderColor: ='TotalGM/WO'.BorderColor
                HoverColor: ='TotalGM/WO'.Color
                HoverFill: ='TotalGM/WO'.Fill
                PressedBorderColor: ='TotalGM/WO'.BorderColor
                PressedColor: ='TotalGM/WO'.Color
                PressedFill: ='TotalGM/WO'.Fill
                Size: =16
                Text: |-
                    =/*If(NewEstimate,
                         LookUp(Estimates, ProjectID = NewEstimateProjectID And Stage = NewEstimateStage 
                           And Version = NewEstimateVersion And Type = NewEstimateType, "GM" & Text((Sum(Gallery5.AllItems, TotalQ) - Sum(Gallery5.AllItems,totalValue))/Sum(Gallery5.AllItems, TotalQ)* 100, "[$-en-US]#.00 %")),
                        LookUp(Estimates,  ProjectID = EstimatesGallery.Selected.ProjectID And Stage = EstimatesGallery.Selected.Stage 
                            And Version  = EstimatesGallery.Selected.Version And Type = EstimatesGallery.Selected.Type, 
                        "GM: " & Text((Sum(Gallery5.AllItems, TotalQ) - Sum(Gallery5.AllItems,totalValue))/Sum(Gallery5.AllItems, TotalQ)* 100, "[$-en-US]#.00 %")))*/
                    
                    "GM: " & Text((Sum(Gallery5.AllItems, TotalQ) - Sum(Gallery5.AllItems,totalValue))/Sum(Gallery5.AllItems, TotalQ)* 100, "[$-en-US]#.00 %")
                Width: =172
                X: =1050
                Y: =613
                ZIndex: =67

            "'TotalGM/W' As label":
                Color: =RGBA(111, 162, 135, 1)
                FocusedBorderColor: ='TotalGM/W'.BorderColor
                FontWeight: =FontWeight.Bold
                Height: =42
                HoverBorderColor: ='TotalGM/W'.BorderColor
                HoverColor: ='TotalGM/W'.Color
                HoverFill: ='TotalGM/W'.Fill
                PressedBorderColor: ='TotalGM/W'.BorderColor
                PressedColor: ='TotalGM/W'.Color
                PressedFill: ='TotalGM/W'.Fill
                Size: =14
                Text: |-
                    ="GM: " & Text((Sum(Gallery5.AllItems, TotalQ) - Sum(Gallery5.AllItems,totalValue) - Sum(Gallery5.AllItems,conValue))/Sum(Gallery5.AllItems, TotalQ)* 100, "[$-en-US]#.00 %")
                Width: =205
                X: =1060
                Y: =800
                ZIndex: =71

            Button13_1 As button:
                BorderColor: =ColorFade(Button13_1.Fill, -15%)
                Fill: =RGBA(36, 76, 90, 1)
                FocusedBorderColor: =Button13_1.BorderColor
                Height: =62
                HoverBorderColor: =ColorFade(Button13_1.BorderColor, 20%)
                HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
                OnSelect: |
                    =Patch(
                        Estimates,
                        LookUp(
                            Estimates,
                            ProjectID = DataCardValue1_2.Text And Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text
                        ),
                        {
                            epc_cost_per: Value(EPC_COST_percentage.Text),
                            epc_chevy_per: Value(EPC_CHEVY_percentage.Text),
                            contingency_percentage: Value(estConPercentage.Text),
                            markup_percentage: Value(estMarkPercentage.Text)
                        }
                    );
                    Launch(
                        Concatenate(
                            "https://pecintranetsrv.primaryeng.com/EstimateWorkBook_PO.php?",
                            "projectID=",
                            DataCardValue1_2.Text,
                            "&stage=",
                            NewEstStage_2.Selected.Value,
                            "&version=",
                            NewEstVersion_2.Selected.Value,
                            "&estimateType=",
                            DataCardValue2_2.Text
                        )
                    );
                PressedBorderColor: =Button13_1.Fill
                PressedColor: =Button13_1.Fill
                PressedFill: =Button13_1.Color
                Text: |-
                    ="Save & 
                    Download for Acumatica's PO"
                Width: =312
                X: =27
                Y: =1088
                ZIndex: =72

    NewEstBackIcon As icon.ChevronLeft:
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(255, 255, 255, 1)
        DisabledFill: =NewEstBackIcon.Fill
        FocusedBorderColor: =NewEstBackIcon.BorderColor
        HoverBorderColor: =ColorFade(NewEstBackIcon.BorderColor, 20%)
        HoverColor: =ColorFade(NewEstBackIcon.Color, 20%)
        HoverFill: =NewEstBackIcon.Fill
        Icon: =Icon.ChevronLeft
        OnSelect: |-
            =UpdateContext({NewEstPopUp:true,NewEstOkButton:true, 
                 NewEstPopMsgText:""});
            /*UpdateContext({NewEstPopUp:true,NewEstOkButton:true, 
                 NewEstPopMsgText:Concatenate("Choose one of the following options:", Char(10), Char(10), "Press Cancel to stay on the same screen.", Char(10),                      Char(10), "Press OK to go back")
            });
            
            */
        PressedBorderColor: =ColorFade(NewEstBackIcon.BorderColor, -20%)
        PressedColor: =ColorFade(NewEstBackIcon.Color, -20%)
        PressedFill: =NewEstBackIcon.Fill
        Tooltip: ="Go back"
        X: =1287
        Y: =12
        ZIndex: =5

    SaveNewEstimate As icon.Save:
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(255, 255, 255, 1)
        DisabledFill: =SaveNewEstimate.Fill
        FocusedBorderColor: =SaveNewEstimate.BorderColor
        HoverBorderColor: =ColorFade(SaveNewEstimate.BorderColor, 20%)
        HoverColor: =ColorFade(SaveNewEstimate.Color, 20%)
        HoverFill: =SaveNewEstimate.Fill
        Icon: =Icon.Save
        OnSelect: |
            =//First check that (ProjectID,Stage,Version) as a PK doesn't already exist and then proceed to SAVE FOR THE FIRST TIME, if exists the prompt for a new combination of (ProjectID,Stage,Version)
            //Refresh('[dbo].[Estimates]');
            If(Trim(DataCardValue1_2.Text) = "",
             UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
             If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
            	   //true code
            	   If(FirstSaveOnNewEstimate, 
            	   //true code Updating after the first save
            		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
            				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
            				{
            				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                            Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
            				Description: DataCardValue5_2.Text, 
            				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
            				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
            				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
            				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
            				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
            				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
            				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
            				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                            //Quote_Cost: Value(QuoteCost.Text),
                            epc_cost_per: Value(EPC_COST_percentage.Text),
                            epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                            contingency_percentage: Value(estConPercentage.Text),
                            markup_percentage: Value(estMarkPercentage.Text),
            				Notes: DataCardValue3_2.Text, 
                            LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});,
            		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
            	  UpdateContext({NewEstPopUp:true, 
                                NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
            					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                 Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true})
            		),
            	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
            	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
            	  If(Not(FirstSaveOnNewEstimate), 
            		 Set(FirstSaveOnNewEstimate, true);
            		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
            		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
            				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
            				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
            				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                            ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                            Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
            				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                            p_percentage: Value("0.0"), 
                            d_percentage:Value("0.0"),
            				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
            				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
            				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
            				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
            				EPC_Sec_TotalCost: Value("0.0"),
                            Quote_Cost: Value("0.0"), 
                            epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                            epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                            contingency_percentage: LookUp(MarkUp_ContingencyTable, id_con_markup = 1, contingeny),
                            markup_percentage: LookUp(MarkUp_ContingencyTable, id_con_markup = 1, markup),
            				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
            		}),
            		""
            		);  
            	);
            );
            Refresh(Estimates);
        PressedBorderColor: =ColorFade(SaveNewEstimate.BorderColor, -20%)
        PressedColor: =ColorFade(SaveNewEstimate.Color, -20%)
        PressedFill: =SaveNewEstimate.Fill
        Tooltip: ="Save Estimate"
        Visible: =false
        X: =201
        Y: =12
        ZIndex: =6

    NewEstPopWindow As rectangle:
        BorderStyle: =BorderStyle.Dashed
        BorderThickness: =2
        DisabledFill: =NewEstPopWindow.Fill
        Fill: =RGBA(241, 244, 249, 0.9)
        FocusedBorderColor: =NewEstPopWindow.BorderColor
        Height: =719
        HoverFill: =NewEstPopWindow.Fill
        PressedFill: =NewEstPopWindow.Fill
        Visible: =NewEstPopUp
        Width: =1321
        X: =30
        Y: =12
        ZIndex: =7

    NewEstPopMsg As label:
        Color: =RGBA(168, 0, 0, 1)
        FocusedBorderColor: =NewEstPopMsg.BorderColor
        FontWeight: =FontWeight.Bold
        Height: =230
        HoverBorderColor: =NewEstPopMsg.BorderColor
        HoverColor: =NewEstPopMsg.Color
        HoverFill: =NewEstPopMsg.Fill
        PressedBorderColor: =NewEstPopMsg.BorderColor
        PressedColor: =NewEstPopMsg.Color
        PressedFill: =NewEstPopMsg.Fill
        Size: =18
        Text: =Text(NewEstPopMsgText)
        VerticalAlign: =VerticalAlign.Top
        Visible: =NewEstPopUp
        Width: =1198
        X: =72
        Y: =124
        ZIndex: =8

    NewEstOK_Button As button:
        BorderColor: =ColorFade(NewEstOK_Button.Fill, -15%)
        Fill: =RGBA(36, 76, 90, 1)
        FocusedBorderColor: =NewEstOK_Button.BorderColor
        Height: =71
        HoverBorderColor: =ColorFade(NewEstOK_Button.BorderColor, 20%)
        HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
        OnSelect: |-
            =If(Trim(DataCardValue1_2.Text) = "",
             UpdateContext({NewEstPopUp:true, NewEstPopMsgText: Concatenate("Project ID is empty therefore this estimate can't be save.",""), NewEst_AllPurposeOkButton:true}),
             If(LookUp(Estimates, ProjectID = DataCardValue1_2.Text And Stage =  NewEstStage_2.SelectedText.Value And Version = NewEstVersion_2.SelectedText.Value,  Type = DataCardValue2_2.Text),
            	   //true code
            	   If(FirstSaveOnNewEstimate, 
            	   //true code Updating after the first save
            		UpdateContext({PatchEstBasicRes:Patch(Estimates, LookUp(Estimates, ProjectID = DataCardValue1_2.Text And
            				 Stage = NewEstStage_2.Selected.Value And Version = NewEstVersion_2.Selected.Value And Type = DataCardValue2_2.Text),
            				{
            				ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                            Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text,
            				Description: DataCardValue5_2.Text, 
            				Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
            				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName', 
            				//Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
            				//Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
            				//Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
            				//Permit_M_Cost : Value(EstPermitMatCost_2.Text), Permit_L_Cost : Value(EstPermitLabCost_2.Text),
            				//Extra_M_Cost: Value(EstXtraMatCost_2.Text), Extra_L_Cost: Value(EstXtraLabCost_2.Text),
            				//EPC_Sec_TotalCost: Value(EstEPCCost_2.Text),
                            //Quote_Cost: Value(QuoteCost.Text),
                            epc_cost_per: Value(EPC_COST_percentage.Text),
                            epc_chevy_per:Value(EPC_CHEVY_percentage.Text),
                            contingency_percentage: Value(estConPercentage.Text),
                            markup_percentage: Value(estMarkPercentage.Text),
            				Notes: DataCardValue3_2.Text, 
                            LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})});
                            UpdateContext({NewEstPopUp:false, NewEstOkButton:false});
                            ResetForm(BasicInfo_Form);Reset(SearchBox);
                            Set(FirstSaveOnNewEstimate, false);
                            If(NewEstimate, Navigate(MainScreen,ScreenTransition.Fade), Navigate(EstimatesGalleryScreen,ScreenTransition.Fade));,
            		//False code (ProjectID,Stage,Version) PK ALREADY EXISTS
            	  UpdateContext({NewEstPopUp:true, 
                                NewEstPopMsgText: Concatenate("An Estimate already exists for: ", DataCardValue1_2.Text, " ",
            					 NewEstStage_2.SelectedText.Value , " ",  NewEstVersion_2.SelectedText.Value,
                                 Char(13), Char(13), "Press Ok to exit this message"), NewEst_AllPurposeOkButton:true, NewEstOkButton:false})
            		),
            	  //Else (ProjectID,Stage,Version) is a NEW PK AND SAVE IT FOR THE FIRST TIME
            	  Set(NewEstimateProjectID,  DataCardValue1_2.Text); Set(NewEstimateStage, NewEstStage_2.SelectedText.Value);Set(NewEstimateVersion,  NewEstVersion_2.SelectedText.Value);Set(NewEstimateVendor, NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName'); 
            	  If(Not(FirstSaveOnNewEstimate), 
            		 Set(FirstSaveOnNewEstimate, true);
            		 // saving new estimate for the VERY FIRST TIME with DEFAULTS and PROVIDED BASIC VALUES
            		 UpdateContext({PatchEstBasicRes:Patch(Estimates, Defaults(Estimates),
            				{ProjectID: DataCardValue1_2.Text,Stage:  NewEstStage_2.SelectedText.Value, Version: NewEstVersion_2.SelectedText.Value, Type: DataCardValue2_2.Text, 
            				Description: DataCardValue5_2.Text, EstimatedBy: Concatenate(User().FullName, " at ", Text(Now())), DateCreated:Today(), Contractor: NewEstLabContractor_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BContractorName',
            				MaterialSupplier: NewEstMatSupplier_2.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BVendorName',
                            ClientNumber: DataCardValue3.Text, Address: DataCardValue4.Text,
                            Designer: DataCardValue82.Text, ProjectManager: DataCardValue111.Text, 
            				Eng_P_Cost:Value("0.0"), Eng_D_Cost:Value("0.0"), 
                            p_percentage: Value("0.0"), 
                            d_percentage:Value("0.0"),
            				Struc_M_Cost:Value(EstStrucMatCost_2.Text), Struc_L_Cost: Value(EstStrucLabCost_2.Text),
            				Material_Cost:Value(EstMatCost_2.Text), Labour_Cost:Value(EstLabCost_2.Text),
            				Permit_M_Cost : Value("0.0"), Permit_L_Cost : Value("0.0"),
            				Extra_M_Cost: Value("0.0"), Extra_L_Cost: Value("0.0"),
            				EPC_Sec_TotalCost: Value("0.0"),
                            Quote_Cost: Value("0.0"), 
                            epc_cost_per: LookUp(EPC_table, epc_ID = 14,epc_percentage),
                            epc_chevy_per:LookUp(EPC_table, epc_ID = 15,epc_percentage),
                            contingency_percentage: LookUp(MarkUp_ContingencyTable, id_con_markup = 1, contingeny),
                            markup_percentage: LookUp(MarkUp_ContingencyTable, id_con_markup = 1, markup),
            				Notes: DataCardValue3_2.Text, LastModifiedBy: Concatenate(User().FullName, " at ", Text(Now())), LastModifiedDate:Today()})
            		});
                    UpdateContext({NewEstPopUp:false, NewEstOkButton:false, NewEst_AllPurposeOkButton:false});
                    ResetForm(BasicInfo_Form);Reset(SearchBox);
                    Set(FirstSaveOnNewEstimate, false);
                    If(NewEstimate, Navigate(MainScreen,ScreenTransition.Fade), Navigate(EstimatesGalleryScreen,ScreenTransition.Fade));,
            		""
            		);  
            	);
            );
        PressedBorderColor: =NewEstOK_Button.Fill
        PressedColor: =NewEstOK_Button.Fill
        PressedFill: =NewEstOK_Button.Color
        Text: ="Save"
        Visible: =NewEstOkButton
        Width: =191
        X: =372
        Y: =389
        ZIndex: =9

    NewEstCancel_Button As button:
        BorderColor: =ColorFade(NewEstCancel_Button.Fill, -15%)
        Fill: =RGBA(36, 76, 90, 1)
        FocusedBorderColor: =NewEstCancel_Button.BorderColor
        Height: =71
        HoverBorderColor: =ColorFade(NewEstCancel_Button.BorderColor, 20%)
        HoverFill: =ColorFade(RGBA(36, 76, 90, 1), 20%)
        OnSelect: |-
            =UpdateContext({NewEstPopUp:false, NewEstOkButton:false});
            ResetForm(BasicInfo_Form);Reset(SearchBox);
            Set(FirstSaveOnNewEstimate, false);
            If(NewEstimate, Navigate(MainScreen,ScreenTransition.Fade), Navigate(EstimatesGalleryScreen,ScreenTransition.Fade));
        PressedBorderColor: =NewEstCancel_Button.Fill
        PressedColor: =NewEstCancel_Button.Fill
        PressedFill: =NewEstCancel_Button.Color
        Text: ="Discard Changes & go back"
        Visible: =NewEstOkButton
        Width: =210
        X: =642
        Y: =389
        ZIndex: =10

    NewEst_AllPurpose_OkButton As button:
        BorderColor: =ColorFade(NewEst_AllPurpose_OkButton.Fill, -15%)
        FocusedBorderColor: =NewEst_AllPurpose_OkButton.BorderColor
        Height: =46
        HoverBorderColor: =ColorFade(NewEst_AllPurpose_OkButton.BorderColor, 20%)
        OnSelect: |-
            =UpdateContext({NewEst_AllPurposeOkButton:false, NewEstPopUp:false});
        PressedBorderColor: =NewEst_AllPurpose_OkButton.Fill
        PressedColor: =NewEst_AllPurpose_OkButton.Fill
        PressedFill: =NewEst_AllPurpose_OkButton.Color
        Text: ="OK"
        Visible: =NewEst_AllPurposeOkButton
        X: =528
        Y: =512
        ZIndex: =11

    Icon46 As icon.Reload:
        Color: =RGBA(255, 255, 255, 1)
        DisabledFill: =Icon46.Fill
        FocusedBorderColor: =Icon46.BorderColor
        HoverBorderColor: =ColorFade(Icon46.BorderColor, 20%)
        HoverColor: =ColorFade(Icon46.Color, 20%)
        HoverFill: =Icon46.Fill
        Icon: =Icon.Reload
        OnSelect: |-
            =Refresh(Estimates);
            //Refresh(ProjectEstEngResources);
            //Refresh(ProjEstEPCTable);
        PressedBorderColor: =ColorFade(Icon46.BorderColor, -20%)
        PressedColor: =ColorFade(Icon46.Color, -20%)
        PressedFill: =Icon46.Fill
        Visible: =false
        X: =1216
        Y: =12
        ZIndex: =12

    PECLogo_4 As image:
        BorderColor: =RGBA(255, 255, 255, 1)
        BorderStyle: =BorderStyle.Dashed
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderColor: =PECLogo_4.BorderColor
        Height: =90
        HoverBorderColor: =ColorFade(PECLogo_4.BorderColor, 20%)
        HoverFill: =ColorFade(PECLogo_4.Fill, 20%)
        Image: =PRI_Logo_RGB_TM_201222
        PressedBorderColor: =ColorFade(PECLogo_4.BorderColor, -20%)
        PressedFill: =ColorFade(PECLogo_4.Fill, -20%)
        Width: =168
        ZIndex: =13

    Icon60 As icon.Sync:
        Color: =RGBA(255, 255, 255, 1)
        DisabledFill: =Icon60.Fill
        HoverBorderColor: =ColorFade(Icon60.BorderColor, 20%)
        HoverColor: =ColorFade(Icon60.Color, 20%)
        HoverFill: =Icon60.Fill
        Icon: =Icon.Sync
        OnSelect: |-
            =Launch(
                Concatenate(
                    "https://pecintranetsrv.primaryeng.com/EstimateUpdatePriceAction_V2.php?",
                    "projectID=",
                    DataCardValue1_2.Text,
                    "&stage=",
                    NewEstStage_2.Selected.Value,
                    "&version=",
                    NewEstVersion_2.Selected.Value,
                    "&estimateType=",
                    DataCardValue2_2.Text,
                    "&supplier=", NewEstMatSupplier_2.Selected.VendorName,
                    "&contractor=", NewEstLabContractor_2.Selected.ContractorName
            
                )
            );
            UpdateContext({NewEstPopUp:false, NewEstOkButton:false});
            ResetForm(BasicInfo_Form);Reset(SearchBox);
            Set(FirstSaveOnNewEstimate, false);
            If(NewEstimate, Navigate(MainScreen,ScreenTransition.Fade), Navigate(EstimatesGalleryScreen,ScreenTransition.Fade));
        PressedBorderColor: =ColorFade(Icon60.BorderColor, -20%)
        PressedColor: =ColorFade(Icon60.Color, -20%)
        PressedFill: =Icon60.Fill
        Tooltip: ="Update Pricing"
        Visible: |-
            =If(NewEstimate, 
                false,
                If(LookUp(Estimates, ProjectID = Trim(DataCardValue1_2.Text) And Stage = NewEstStage_2.Selected.Value And 
                                     Version = NewEstVersion_2.Selected.Value And Type = Trim(DataCardValue2_2.Text), MaterialSupplier) =  NewEstMatSupplier_2.Selected.VendorName,
                    true,
                    false)
            )
        X: =1206
        Y: =12
        ZIndex: =16

    MainScreenSpinnerGrp As group:
        Height: =5
        Width: =5
        X: =40
        Y: =-48
        ZIndex: =16

        Rectangle1_2 As rectangle:
            DisabledFill: =Rectangle1_2.Fill
            Fill: =RGBA(255,255, 255, 0.85)
            Height: =680
            HoverFill: =Rectangle1_2.Fill
            PressedFill: =Rectangle1_2.Fill
            Visible: =ShowMainSpinner
            Width: =1366
            Y: =88
            ZIndex: =14

        Image1_2 As image:
            Height: =135
            HoverBorderColor: =ColorFade(Image1_2.BorderColor, 20%)
            HoverFill: =ColorFade(Image1_2.Fill, 20%)
            Image: ='Pulse-1s-200px'
            PressedBorderColor: =ColorFade(Image1_2.BorderColor, -20%)
            PressedFill: =ColorFade(Image1_2.Fill, -20%)
            Visible: =ShowMainSpinner
            Width: =199
            X: =623
            Y: =336
            ZIndex: =15

